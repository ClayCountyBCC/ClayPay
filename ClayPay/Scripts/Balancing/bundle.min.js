var Utilities,clayPay,Balancing;(function(n,t){typeof exports=="object"&&typeof module!="undefined"?t():typeof define=="function"&&define.amd?define(t):t()})(this,function(){"use strict";function s(){}function h(n,t){return function(){n.apply(t,arguments)}}function n(t){if(!(this instanceof n))throw new TypeError("Promises must be constructed via new");if(typeof t!="function")throw new TypeError("not a function");this._state=0;this._handled=!1;this._value=undefined;this._deferreds=[];e(t,this)}function f(r,u){while(r._state===3)r=r._value;if(r._state===0){r._deferreds.push(u);return}r._handled=!0;n._immediateFn(function(){var n=r._state===1?u.onFulfilled:u.onRejected,f;if(n===null){(r._state===1?i:t)(u.promise,r._value);return}try{f=n(r._value)}catch(e){t(u.promise,e);return}i(u.promise,f)})}function i(i,u){try{if(u===i)throw new TypeError("A promise cannot be resolved with itself.");if(u&&(typeof u=="object"||typeof u=="function")){var f=u.then;if(u instanceof n){i._state=3;i._value=u;r(i);return}if(typeof f=="function"){e(h(f,u),i);return}}i._state=1;i._value=u;r(i)}catch(o){t(i,o)}}function t(n,t){n._state=2;n._value=t;r(n)}function r(t){t._state===2&&t._deferreds.length===0&&n._immediateFn(function(){t._handled||n._unhandledRejectionFn(t._value)});for(var i=0,r=t._deferreds.length;i<r;i++)f(t,t._deferreds[i]);t._deferreds=null}function c(n,t,i){this.onFulfilled=typeof n=="function"?n:null;this.onRejected=typeof t=="function"?t:null;this.promise=i}function e(n,r){var u=!1;try{n(function(n){u||(u=!0,i(r,n))},function(n){u||(u=!0,t(r,n))})}catch(f){if(u)return;u=!0;t(r,f)}}var o=setTimeout,u;n.prototype["catch"]=function(n){return this.then(null,n)};n.prototype.then=function(n,t){var i=new this.constructor(s);return f(this,new c(n,t,i)),i};n.prototype["finally"]=function(n){var t=this.constructor;return this.then(function(i){return t.resolve(n()).then(function(){return i})},function(i){return t.resolve(n()).then(function(){return t.reject(i)})})};n.all=function(t){return new n(function(n,i){function e(t,u){try{if(u&&(typeof u=="object"||typeof u=="function")){var o=u.then;if(typeof o=="function"){o.call(u,function(n){e(t,n)},i);return}}r[t]=u;--f==0&&n(r)}catch(s){i(s)}}var r,f,u;if(!t||typeof t.length=="undefined")throw new TypeError("Promise.all accepts an array");if(r=Array.prototype.slice.call(t),r.length===0)return n([]);for(f=r.length,u=0;u<r.length;u++)e(u,r[u])})};n.resolve=function(t){return t&&typeof t=="object"&&t.constructor===n?t:new n(function(n){n(t)})};n.reject=function(t){return new n(function(n,i){i(t)})};n.race=function(t){return new n(function(n,i){for(var r=0,u=t.length;r<u;r++)t[r].then(n,i)})};n._immediateFn=typeof setImmediate=="function"&&function(n){setImmediate(n)}||function(n){o(n,0)};n._unhandledRejectionFn=function(n){typeof console!="undefined"&&console&&console.warn("Possible Unhandled Promise Rejection:",n)};u=function(){if(typeof self!="undefined")return self;if(typeof window!="undefined")return window;if(typeof global!="undefined")return global;throw new Error("unable to locate global object");}();u.Promise||(u.Promise=n)}),function(n){"use strict";function f(n){if(typeof n!="string"&&(n=String(n)),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(n))throw new TypeError("Invalid character in header field name");return n.toLowerCase()}function s(n){return typeof n!="string"&&(n=String(n)),n}function e(n){var t={next:function(){var t=n.shift();return{done:t===undefined,value:t}}};return i.iterable&&(t[Symbol.iterator]=function(){return t}),t}function t(n){this.map={};n instanceof t?n.forEach(function(n,t){this.append(t,n)},this):Array.isArray(n)?n.forEach(function(n){this.append(n[0],n[1])},this):n&&Object.getOwnPropertyNames(n).forEach(function(t){this.append(t,n[t])},this)}function o(n){if(n.bodyUsed)return Promise.reject(new TypeError("Already read"));n.bodyUsed=!0}function h(n){return new Promise(function(t,i){n.onload=function(){t(n.result)};n.onerror=function(){i(n.error)}})}function b(n){var t=new FileReader,i=h(t);return t.readAsArrayBuffer(n),i}function k(n){var t=new FileReader,i=h(t);return t.readAsText(n),i}function d(n){for(var i=new Uint8Array(n),r=new Array(i.length),t=0;t<i.length;t++)r[t]=String.fromCharCode(i[t]);return r.join("")}function c(n){if(n.slice)return n.slice(0);var t=new Uint8Array(n.byteLength);return t.set(new Uint8Array(n)),t.buffer}function l(){return this.bodyUsed=!1,this._initBody=function(n){if(this._bodyInit=n,n)if(typeof n=="string")this._bodyText=n;else if(i.blob&&Blob.prototype.isPrototypeOf(n))this._bodyBlob=n;else if(i.formData&&FormData.prototype.isPrototypeOf(n))this._bodyFormData=n;else if(i.searchParams&&URLSearchParams.prototype.isPrototypeOf(n))this._bodyText=n.toString();else if(i.arrayBuffer&&i.blob&&p(n))this._bodyArrayBuffer=c(n.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer]);else if(i.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(n)||w(n)))this._bodyArrayBuffer=c(n);else throw new Error("unsupported BodyInit type");else this._bodyText="";this.headers.get("content-type")||(typeof n=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):i.searchParams&&URLSearchParams.prototype.isPrototypeOf(n)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},i.blob&&(this.blob=function(){var n=o(this);if(n)return n;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");else return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?o(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(b)}),this.text=function(){var n=o(this);if(n)return n;if(this._bodyBlob)return k(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(d(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");else return Promise.resolve(this._bodyText)},i.formData&&(this.formData=function(){return this.text().then(nt)}),this.json=function(){return this.text().then(JSON.parse)},this}function g(n){var t=n.toUpperCase();return a.indexOf(t)>-1?t:n}function u(n,i){i=i||{};var r=i.body;if(n instanceof u){if(n.bodyUsed)throw new TypeError("Already read");this.url=n.url;this.credentials=n.credentials;i.headers||(this.headers=new t(n.headers));this.method=n.method;this.mode=n.mode;r||n._bodyInit==null||(r=n._bodyInit,n.bodyUsed=!0)}else this.url=String(n);if(this.credentials=i.credentials||this.credentials||"omit",(i.headers||!this.headers)&&(this.headers=new t(i.headers)),this.method=g(i.method||this.method||"GET"),this.mode=i.mode||this.mode||null,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&r)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(r)}function nt(n){var t=new FormData;return n.trim().split("&").forEach(function(n){if(n){var i=n.split("="),r=i.shift().replace(/\+/g," "),u=i.join("=").replace(/\+/g," ");t.append(decodeURIComponent(r),decodeURIComponent(u))}}),t}function tt(n){var i=new t,r=n.replace(/\r?\n[\t ]+/g," ");return r.split(/\r?\n/).forEach(function(n){var t=n.split(":"),r=t.shift().trim(),u;r&&(u=t.join(":").trim(),i.append(r,u))}),i}function r(n,i){i||(i={});this.type="default";this.status=i.status===undefined?200:i.status;this.ok=this.status>=200&&this.status<300;this.statusText="statusText"in i?i.statusText:"OK";this.headers=new t(i.headers);this.url=i.url||"";this._initBody(n)}var i,a,v;if(!n.fetch){if(i={searchParams:"URLSearchParams"in n,iterable:"Symbol"in n&&"iterator"in Symbol,blob:"FileReader"in n&&"Blob"in n&&function(){try{return new Blob,!0}catch(n){return!1}}(),formData:"FormData"in n,arrayBuffer:"ArrayBuffer"in n},i.arrayBuffer)var y=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],p=function(n){return n&&DataView.prototype.isPrototypeOf(n)},w=ArrayBuffer.isView||function(n){return n&&y.indexOf(Object.prototype.toString.call(n))>-1};t.prototype.append=function(n,t){n=f(n);t=s(t);var i=this.map[n];this.map[n]=i?i+","+t:t};t.prototype["delete"]=function(n){delete this.map[f(n)]};t.prototype.get=function(n){return n=f(n),this.has(n)?this.map[n]:null};t.prototype.has=function(n){return this.map.hasOwnProperty(f(n))};t.prototype.set=function(n,t){this.map[f(n)]=s(t)};t.prototype.forEach=function(n,t){for(var i in this.map)this.map.hasOwnProperty(i)&&n.call(t,this.map[i],i,this)};t.prototype.keys=function(){var n=[];return this.forEach(function(t,i){n.push(i)}),e(n)};t.prototype.values=function(){var n=[];return this.forEach(function(t){n.push(t)}),e(n)};t.prototype.entries=function(){var n=[];return this.forEach(function(t,i){n.push([i,t])}),e(n)};i.iterable&&(t.prototype[Symbol.iterator]=t.prototype.entries);a=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];u.prototype.clone=function(){return new u(this,{body:this._bodyInit})};l.call(u.prototype);l.call(r.prototype);r.prototype.clone=function(){return new r(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new t(this.headers),url:this.url})};r.error=function(){var n=new r(null,{status:0,statusText:""});return n.type="error",n};v=[301,302,303,307,308];r.redirect=function(n,t){if(v.indexOf(t)===-1)throw new RangeError("Invalid status code");return new r(null,{status:t,headers:{location:n}})};n.Headers=t;n.Request=u;n.Response=r;n.fetch=function(n,t){return new Promise(function(f,e){var s=new u(n,t),o=new XMLHttpRequest;o.onload=function(){var n={status:o.status,statusText:o.statusText,headers:tt(o.getAllResponseHeaders()||"")},t;n.url="responseURL"in o?o.responseURL:n.headers.get("X-Request-URL");t="response"in o?o.response:o.responseText;f(new r(t,n))};o.onerror=function(){e(new TypeError("Network request failed"))};o.ontimeout=function(){e(new TypeError("Network request failed"))};o.open(s.method,s.url,!0);s.credentials==="include"?o.withCredentials=!0:s.credentials==="omit"&&(o.withCredentials=!1);"responseType"in o&&i.blob&&(o.responseType="blob");s.headers.forEach(function(n,t){o.setRequestHeader(t,n)});o.send(typeof s._bodyInit=="undefined"?null:s._bodyInit)})};n.fetch.polyfill=!0}}(typeof self!="undefined"?self:this),function(n){function t(n){typeof n=="string"&&(n=document.getElementById(n));n.classList.add("hide");n.classList.remove("show");n.classList.remove("show-inline");n.classList.remove("show-flex")}function i(n){typeof n=="string"&&(n=document.getElementById(n));n.classList.add("show");n.classList.remove("hide");n.classList.remove("show-inline");n.classList.remove("show-flex")}function o(n){typeof n=="string"&&(n=document.getElementById(n));n.classList.add("show-inline");n.classList.remove("hide");n.classList.remove("show");n.classList.remove("show-flex")}function s(n){typeof n=="string"&&(n=document.getElementById(n));n.classList.add("show-flex");n.classList.remove("hide");n.classList.remove("show-inline");n.classList.remove("show")}function u(n,u,f){if(typeof n=="string"&&(n=document.getElementById(n)),u){r(n);let i=document.createElement("div");i.classList.add("notification");i.classList.add("is-danger");let f=document.createElement("button");if(f.classList.add("delete"),f.onclick=()=>{t(n)},i.appendChild(f),Array.isArray(u)){let n=document.createElement("ul");u.forEach(t=>{let i=document.createElement("li");i.appendChild(document.createTextNode(t));n.appendChild(i)});i.appendChild(n)}else i.appendChild(document.createTextNode(u));n.appendChild(i)}i(n);(f==undefined||f===!0)&&window.setTimeout(function(){t(n)},1e4)}function r(n){if(n!==null&&n!==undefined)while(n.firstChild)n.removeChild(n.firstChild)}function h(n,t,i=false){let r=document.createElement("option");return r.value=n,r.text=t,r.selected=i,r}function f(n){return typeof n=="string"&&(n=document.getElementById(n)),n.value}function c(n,t){typeof n=="string"&&(n=document.getElementById(n));n.value=t}function l(n,t){typeof n=="string"&&(n=document.getElementById(n));r(n);n.appendChild(document.createTextNode(t))}function a(n){let i=n.replace("nav-",""),t=document.querySelectorAll("#menuTabs > li > a");if(t.length>0)for(let i=0;i<t.length;i++){let r=t.item(i);r.id===n?r.parentElement.classList.add("is-active"):r.parentElement.classList.remove("is-active")}e("#views > section",i)}function e(n,r){let u=document.querySelectorAll(n);if(u.length>0)for(let n=0;n<u.length;n++){let f=u.item(n);f.id===r?i(f):t(f)}}function v(n){return fetch(n,{method:"GET",headers:{"Content-Type":"application/json"},cache:"no-cache",credentials:"include"}).then(n=>{if(!n.ok)throw new Error(n.statusText);return n.json()})}function y(n,t){return fetch(n,{method:"POST",body:JSON.stringify(t),cache:"no-cache",headers:{"Content-Type":"application/json"},credentials:"include"}).then(n=>{if(console.log("Post Response",n),!n.ok)throw new Error(n.statusText);return n.json()})}function p(n){return n.toLocaleString("en-US",{style:"currency",currency:"USD"})}function w(n){return n instanceof Date?n.toLocaleDateString("en-us"):new Date(n).toLocaleString("en-US")}function b(n,t,i){typeof n=="string"&&(n=document.getElementById(n));let r=n;r.tagName.toLowerCase()==="select"?r.parentElement.classList.remove("is-danger"):r.classList.remove("is-danger");let e=f(r).trim();return e.length==0?(r.tagName.toLowerCase()==="select"?r.parentElement.classList.add("is-danger"):r.classList.add("is-danger"),u(t,i),r.focus(),r.scrollTo(),""):e}function k(n,t){typeof n=="string"&&(n=document.getElementById(n));let i=n;i.disabled=t;i.classList.toggle("is-loading",t)}function d(t){let r=document.createElement("li");t.selected&&r.classList.add("is-active");let i=document.createElement("a");if(i.id=t.id,i.href="#",i.onclick=function(){let i=document.getElementById("menuTitle"),r=document.getElementById("menuSubTitle");n.Clear_Element(i);n.Clear_Element(r);i.appendChild(document.createTextNode(t.title));r.appendChild(document.createTextNode(t.subTitle));n.Show_Menu(t.id)},t.icon.length>0){let n=document.createElement("span");n.classList.add("icon");n.classList.add("is-medium");let r=document.createElement("i"),u=t.icon.split(" ");for(let n of u)r.classList.add(n);n.appendChild(r);i.appendChild(n)}return i.appendChild(document.createTextNode(t.label)),r.appendChild(i),r}n.Hide=t;n.Show=i;n.Show_Inline=o;n.Show_Flex=s;n.Error_Show=u;n.Clear_Element=r;n.Create_Option=h;n.Get_Value=f;n.Set_Value=c;n.Set_Text=l;n.Show_Menu=a;n.Show_Hide_Selector=e;n.Get=v;n.Post=y;n.Format_Amount=p;n.Format_Date=w;n.Validate_Text=b;n.Toggle_Loading_Button=k;n.Create_Menu_Element=d}(Utilities||(Utilities={})),function(n){let t;(function(n){n[n.search_results=0]="search_results";n[n.cart=1]="cart";n[n.receipt=2]="receipt"})(t=n.ChargeView||(n.ChargeView={}));class i{constructor(){this.ItemId=0;this.Description="";this.TimeStampDisplay=""}static CreateTable(i){let u=document.createElement("table");u.classList.add("table");u.classList.add("is-fullwidth");let f=document.createElement("THEAD"),r=document.createElement("tr");return r.appendChild(n.UI.createTableHeaderElement("Key","20%")),i!==t.receipt?(r.appendChild(n.UI.createTableHeaderElement("Description","40%")),r.appendChild(n.UI.createTableHeaderElement("Date","15%")),r.appendChild(n.UI.createTableHeaderElement("Amount","15%")),r.appendChild(n.UI.createTableHeaderElement("","10%"))):(r.appendChild(n.UI.createTableHeaderElement("Description","50%")),r.appendChild(n.UI.createTableHeaderElement("Amount","30%"))),f.appendChild(r),u.appendChild(f),u}static CreateChargesTable(n,t){let u=document.createDocumentFragment(),r=i.CreateTable(t),f=document.createElement("TBODY");n.forEach(function(n){f.appendChild(i.buildChargeRow(n,t))});let e=document.createElement("TFOOT");return e.appendChild(i.buildChargeFooterRow(n,t)),r.appendChild(f),r.appendChild(e),u.appendChild(r),u}static buildChargeFooterRow(r,u){let e=document.createDocumentFragment(),f=document.createElement("tr");f.appendChild(n.UI.createTableElement("","",u===t.receipt?1:2));f.appendChild(n.UI.createTableElement("Total","has-text-weight-bold has-text-right",1));let o=r.reduce((n,t)=>n+t.Total,0);f.appendChild(n.UI.createTableElement(Utilities.Format_Amount(o),""));u===t.search_results?f.appendChild(i.createAddAllChargesToCartButton()):u!==t.receipt&&f.appendChild(n.UI.createTableElement("","",1));e.appendChild(f);switch(u){case t.search_results:e.appendChild(i.createViewCartFooterRow());break;case t.cart:n.CurrentTransaction.TotalAmountDue=o;n.CurrentTransaction.UpdateTotals();e.appendChild(i.buildConvFeeFooterRow())}return e}static buildConvFeeFooterRow(){let t=document.createElement("tr");return t.style.fontWeight="bolder",t.appendChild(n.UI.createTableElement("There is a nonrefundable transaction fee charged for Credit Card Payments by our payment provider. This is charged in addition to the total above.","",2)),t.appendChild(n.UI.createTableElement("Conv. Fee","center",1)),t.appendChild(n.UI.createTableElement(n.ConvenienceFee,"",1)),t.appendChild(n.UI.createTableElement("","",1)),t}static buildChargeRow(r,u){let f=document.createElement("tr");return f.appendChild(n.UI.createTableElement(r.AssocKey)),f.appendChild(n.UI.createTableElement(r.Description,"left")),u!==t.receipt&&f.appendChild(n.UI.createTableElement(r.TimeStampDisplay,"center")),f.appendChild(n.UI.createTableElement(Utilities.Format_Amount(r.Total),"center")),u!==t.receipt&&f.appendChild(i.createChargeCartButtonToggle("Add to Cart",r.ItemId,"center",!0)),f}static createAddAllChargesToCartButton(){let i=document.createElement("td"),t=document.createElement("button");return t.type="button",t.classList.add("button"),t.classList.add("is-primary"),t.appendChild(document.createTextNode("Add All To Cart")),t.onclick=()=>{for(let t of n.CurrentTransaction.CurrentCharges)n.UI.IsItemInCart(t.ItemId)||n.CurrentTransaction.Cart.push(t);n.UI.updateCart();n.UI.ProcessSearchResults(n.CurrentTransaction.CurrentCharges)},i.appendChild(t),i}static createChargeCartButtonToggle(t,i,r){let e=document.createElement("a"),f=document.createElement("div"),u=document.createElement("button"),s=n.UI.IsItemInCart(i),o=document.createElement("td");return o.className=r,u.style.display=s?"none":"inline-block",u.type="button",u.className="button is-primary",u.onclick=()=>{let t=n.CurrentTransaction.CurrentCharges.filter(n=>n.ItemId==i);t.length===1&&n.CurrentTransaction.Cart.indexOf(t[0])===-1&&n.CurrentTransaction.Cart.push(t[0]);f.style.display="inline-block";u.style.display="none";n.UI.updateCart()},f.style.display=s?"inline-block":"none",f.appendChild(document.createTextNode("Added (")),e.classList.add("is-warning"),e.style.cursor="pointer",e.appendChild(document.createTextNode("remove")),e.onclick=()=>{let t=n.CurrentTransaction.Cart.filter(n=>n.ItemId!==i);n.CurrentTransaction.Cart=t;n.UI.updateCart();f.style.display="none";u.style.display="inline-block"},f.appendChild(e),f.appendChild(document.createTextNode(")")),u.appendChild(document.createTextNode(t)),o.appendChild(u),o.appendChild(f),o}static createViewCartFooterRow(){let i=document.createElement("tr");i.appendChild(n.UI.createTableElement("","",4));let r=document.createElement("td"),t=document.createElement("button");return t.type="button",t.classList.add("button"),t.classList.add("is-success"),t.onclick=()=>{let u=n.UI.Menus.filter(function(n){return n.id==="nav-cart"}),t=u[0],i=document.getElementById("menuTitle"),r=document.getElementById("menuSubTitle");Utilities.Clear_Element(i);Utilities.Clear_Element(r);i.appendChild(document.createTextNode(t.title));r.appendChild(document.createTextNode(t.subTitle));Utilities.Show_Menu(t.id)},t.appendChild(document.createTextNode("View Cart")),r.appendChild(t),i.appendChild(r),i}}n.Charge=i}(clayPay||(clayPay={})),function(n){class t{constructor(){this.CashierId="";this.PayId=-1;this.OTId=-1;this.Info="";this.TransactionDate=new Date;this.PaymentType="";this.PaymentTypeDescription="";this.AmountApplied=-1;this.AmountTendered=-1;this.ChangeDue=-1;this.ConvenienceFeeAmount=-1;this.CheckNumber="";this.TransactionId=""}static CreateReceiptPaymentView(n){let r=document.createDocumentFragment(),u=t.CreateTable(),i=document.createElement("TBODY");for(let n of n){let r=n.CheckNumber.length>0?n.CheckNumber:n.TransactionId;i.appendChild(t.BuildPaymentRow(n.PaymentTypeDescription,n.Info,r,n.AmountTendered,n.AmountApplied))}let o=n.filter(function(n){return n.ChangeDue>0}),f=o.reduce((n,t)=>n+t.ChangeDue,0);f>0&&i.appendChild(t.BuildPaymentRow("Total Change Due","","",f,0));let s=n.filter(function(n){return n.ConvenienceFeeAmount>0}),e=s.reduce((n,t)=>n+t.ConvenienceFeeAmount,0);return e>0&&i.appendChild(t.BuildPaymentRow("Convenience Fee Estimate","","",e,0)),u.appendChild(i),r.appendChild(u),r}static CreateTable(){let i=document.createElement("table");i.classList.add("table");i.classList.add("table");i.classList.add("is-fullwidth");let r=document.createElement("THEAD"),t=document.createElement("tr");return t.appendChild(n.UI.createTableHeaderElement("Payment Type","15%")),t.appendChild(n.UI.createTableHeaderElement("Info","35%")),t.appendChild(n.UI.createTableHeaderElement("Check/Trans#","20%")),t.appendChild(n.UI.createTableHeaderElement("Tendered","15%")),t.appendChild(n.UI.createTableHeaderElement("Applied","15%")),r.appendChild(t),i.appendChild(r),i}static BuildPaymentRow(t,i,r,u,f){let e=document.createElement("tr");return e.appendChild(n.UI.createTableElement(t)),e.appendChild(n.UI.createTableElement(i)),e.appendChild(n.UI.createTableElement(r)),e.appendChild(n.UI.createTableElement(Utilities.Format_Amount(u))),t==="Convenience Fee Estimate"?e.appendChild(n.UI.createTableElement("")):e.appendChild(n.UI.createTableElement(Utilities.Format_Amount(f))),e}}n.ReceiptPayment=t}(clayPay||(clayPay={})),function(n){class t{constructor(){this.ResponseCashierData=new n.CashierData;this.Charges=[];this.ReceiptPayments=[];this.TransactionId="";this.Errors=[];this.PartialErrors=[]}static ShowPaymentReceipt(n){console.log("client response ShowPaymentReceipt",n);let i=document.getElementById(t.ReceiptContainer);Utilities.Clear_Element(i);i.appendChild(t.CreateReceiptView(n));Utilities.Show_Hide_Selector("#views > section",t.ReceiptContainer)}static CreateReceiptView(i){let r=document.createDocumentFragment();return i.ReceiptPayments.length===0?r:(r.appendChild(t.CreateReceiptHeader(i)),r.appendChild(t.CreateReceiptPayerView(i.ResponseCashierData)),r.appendChild(n.Charge.CreateChargesTable(i.Charges,n.ChargeView.receipt)),r.appendChild(n.ReceiptPayment.CreateReceiptPaymentView(i.ReceiptPayments)),r)}static CreateReceiptHeader(n){let t=document.createElement("div");t.classList.add("level");let i=document.createElement("span");i.classList.add("level-item");i.classList.add("title");i.appendChild(document.createTextNode("Payment Receipt for: "+n.ReceiptPayments[0].CashierId));let r=document.createElement("span");r.classList.add("level-item");r.classList.add("subtitle");r.appendChild(document.createTextNode("Transaction Date: "+Utilities.Format_Date(n.ResponseCashierData.TransactionDate)));t.appendChild(i);t.appendChild(r);let u=n.ResponseCashierData.TransactionDate;return t}static CreateReceiptPayerView(n){let i=document.createDocumentFragment();return i.appendChild(t.CreatePayerDataColumns("Name",n.PayerName,"Company Name",n.PayerCompanyName)),i.appendChild(t.CreatePayerDataColumns("Phone Number",n.PayerPhoneNumber,"Email Address",n.PayerEmailAddress)),i.appendChild(t.CreatePayerDataColumns("Street Address",n.PayerStreet1,"Address 2",n.PayerStreet2)),i.appendChild(t.CreatePayerDataColumns("Processed By",n.UserName,"","")),i}static CreatePayerDataColumns(n,i,r,u){let f=document.createElement("div");return f.classList.add("columns"),f.style.marginBottom="0",f.appendChild(t.CreatePayerData(n,i)),f.appendChild(t.CreatePayerData(r,u)),f}static CreatePayerData(n,t){let r=document.createElement("div");r.classList.add("field");r.classList.add("column");let u=document.createElement("label");u.classList.add("label");u.appendChild(document.createTextNode(n));let f=document.createElement("div");f.classList.add("control");let i=document.createElement("input");return i.classList.add("input"),i.classList.add("is-static"),i.readOnly=!0,i.type="text",i.value=t,f.appendChild(i),r.appendChild(u),r.appendChild(f),r}static Search(){Utilities.Toggle_Loading_Button(t.receiptSearchButton,!0);let i=document.getElementById(t.receiptSearchInput),n=i.value.trim().toUpperCase();if(n.length!==9){Utilities.Error_Show(t.receiptSearchError,"Receipts must be 8 digits and a dash, like 18-000001.");return}if(n.length>0){let i="/",r=window.location.pathname.toLowerCase().indexOf("/claypay");r==0&&(i="/claypay/");Utilities.Get(i+"API/Payments/Receipt/?CashierId="+n).then(function(n){console.log("Client Response",n);n.Errors.length>0?Utilities.Error_Show(t.receiptSearchError,n.Errors):t.ShowPaymentReceipt(n);Utilities.Toggle_Loading_Button(t.receiptSearchButton,!1)},function(n){console.log("error in Receipt Search",n);Utilities.Error_Show(t.receiptSearchError,n);Utilities.Toggle_Loading_Button(t.receiptSearchButton,!1)})}else Utilities.Error_Show(t.receiptSearchError,"Invalid search. Please check your entry and try again."),i.focus(),Utilities.Toggle_Loading_Button(t.receiptSearchButton,!1)}}t.CashierErrorTarget="paymentError";t.PublicErrorTarget="publicPaymentError";t.ReceiptContainer="receipt";t.receiptSearchInput="receiptSearch";t.receiptSearchButton="receiptSearchButton";t.receiptSearchError="receiptSearchError";n.ClientResponse=t}(clayPay||(clayPay={})),function(n){class t{constructor(){this.Fund="";this.AccountNumber="";this.Project="";this.ProjectAccount="";this.Total="";this.CashAccount=""}}n.Account=t}(Balancing||(Balancing={})),function(n){class t{constructor(){this.Type="";this.Code="";this.TotalAmount=0}}n.CashierTotal=t}(Balancing||(Balancing={})),function(n){class t{constructor(){}static ShowPayments(t,i,r){let u=document.getElementById(n.Payment.PaymentsContainer);Utilities.Clear_Element(u);let f=document.createDocumentFragment();f.appendChild(n.Payment.CreatePaymentTable(t,i,r));u.appendChild(f)}static CreatePaymentTable(t,i,r){let u=document.createElement("table");u.classList.add("table");u.classList.add("is-bordered");u.classList.add("is-fullwidth");u.appendChild(n.Payment.createPaymentTableHeader(i,r));let f=document.createElement("tbody");for(let t of t){let i=document.createElement("tr");i.appendChild(n.Payment.createTableCellLink("td",t.CashierId,"20%"));i.appendChild(n.Payment.createTableCell("td",t.Name,"40%"));i.appendChild(n.Payment.createTableCell("td",Utilities.Format_Date(t.TransactionDate),"25%"));let r=n.Payment.createTableCell("td",Utilities.Format_Amount(t.Total),"15%");r.classList.add("has-text-right");i.appendChild(r);f.appendChild(i)}return u.appendChild(f),u.appendChild(n.Payment.createPaymentTableFooter()),u}static CreateCloseButton(){let t=document.createElement("button");return t.type="button",t.classList.add("is-primary"),t.classList.add("button"),t.onclick=()=>{Utilities.Hide(n.Payment.PaymentsContainer),Utilities.Show(n.Payment.DJournalTotalsContainer)},t.appendChild(document.createTextNode("Close")),t}static createPaymentTableHeader(t,i){let o=document.createElement("THEAD"),f=document.createElement("tr"),r=document.createElement("th");r.colSpan=2;r.appendChild(document.createTextNode(t+" Payments"));r.classList.add("has-text-centered");r.style.verticalAlign="middle";let e=document.createElement("th");e.classList.add("has-text-centered");e.appendChild(document.createTextNode(i));e.style.verticalAlign="middle";let s=document.createElement("th");s.classList.add("has-text-centered");s.appendChild(n.Payment.CreateCloseButton());f.appendChild(r);f.appendChild(e);f.appendChild(s);o.appendChild(f);let u=document.createElement("tr");u.appendChild(n.Payment.createTableCell("th","Cashier Id","20%"));u.appendChild(n.Payment.createTableCell("th","Name","40%"));u.appendChild(n.Payment.createTableCell("th","Transaction Date","25%"));let h=n.Payment.createTableCell("th","Total","15%","has-text-right");return u.appendChild(h),o.appendChild(u),o}static createPaymentTableFooter(){let r=document.createElement("TFOOT"),t=document.createElement("tr"),u=document.createElement("td");u.colSpan=3;let i=document.createElement("td");return i.classList.add("has-text-centered"),i.appendChild(n.Payment.CreateCloseButton()),t.appendChild(u),t.appendChild(i),r.appendChild(t),r}static createTableCell(n,t,i,r=""){let u=document.createElement(n);return u.width=i,r.length>0&&u.classList.add(r),u.appendChild(document.createTextNode(t)),u}static createTableCellLink(n,t,i){let u=document.createElement(n);u.width=i;let r=document.createElement("a");return r.onclick=()=>{Utilities.Set_Text(r,"loading...");let n="/",i="",u=window.location.pathname.toLowerCase().indexOf("/claypay");u==0&&(n="/claypay/");i="?CashierId="+t;Utilities.Get(n+"API/Balancing/Receipt"+i).then(function(n){console.log("client response",n);Utilities.Set_Text(r,t)},function(n){console.log("error getting client response for cashier id: "+t,n);Utilities.Set_Text(r,t)})},r.appendChild(document.createTextNode(t)),u.appendChild(r),u}}t.PaymentsContainer="djournalPaymentsByType";t.DJournalTotalsContainer="djournalTotals";t.DJournalReceiptContainer="djournalReceipt";n.Payment=t}(Balancing||(Balancing={})),function(n){class t{constructor(){this.ProcessedPaymentTotals=[];this.GUTotals=[];this.GLAccountTotals=[];this.Log=new n.DJournalLog;this.Error=[];this.DJournalDate=new Date;this.DJournalDateFormatted=""}static GetAndShow(n=""){let i="/",u=window.location.pathname.toLowerCase().indexOf("/claypay");u==0&&(i="/claypay/");let r="";n.length>0&&(r="?DateToBalance="+n);Utilities.Get(i+"API/Balancing/GetDJournal"+r).then(function(n){console.log("djournal",n);let i=document.getElementById(t.DJournalDateInput);Utilities.Set_Value(i,n.DJournalDateFormatted);t.BuildDJournalDisplay(n)},function(n){console.log("error",n)})}static BuildDJournalDisplay(n){let i=document.getElementById(t.DJournalTotalsContainer),r=document.createDocumentFragment();r.appendChild(t.CreateDJournalTable(n));Utilities.Clear_Element(i);i.appendChild(r)}static CreateDJournalTable(n){let i=document.createElement("table");i.classList.add("table");i.classList.add("is-fullwidth");i.classList.add("is-bordered");i.appendChild(t.BuildDJournalHeader());let u=document.createElement("tbody"),r=document.createElement("tfoot"),f,e,o;for(let i of n.ProcessedPaymentTotals)switch(i.Type){case"Total Charges":f=i;break;case"Total Deposit":e=i;break;case"Total Payments":o=i;break;case"Check":case"Cash":u.appendChild(t.BuildShortDJournalRow(i,n.DJournalDateFormatted));break;default:u.appendChild(t.BuildPaymentRow(i,n.DJournalDateFormatted))}let s=t.BuildDJournalRow(o.Type,o.TotalAmount,e.Type,e.TotalAmount);s.style.backgroundColor="#fafafa";r.appendChild(s);r.appendChild(t.BuildDJournalRow(f.Type,f.TotalAmount,"",-1));for(let n of n.GUTotals)r.appendChild(t.BuildDJournalRow(n.Type,n.TotalAmount,"",-1));return i.appendChild(u),i.appendChild(r),i}static BuildDJournalHeader(){let r=document.createElement("THEAD"),i=document.createElement("tr"),n=document.createElement("th");n.colSpan=2;n.width="60%";n.classList.add("has-text-right");n.appendChild(document.createTextNode("Payments"));i.appendChild(n);let t=document.createElement("th");return t.colSpan=2,t.width="40%",t.classList.add("has-text-right"),t.appendChild(document.createTextNode("Deposits")),i.appendChild(t),r.appendChild(i),r}static BuildDJournalRow(n,i,r,u){let f=document.createElement("tr");return f.appendChild(t.CreateTableCell(n,"45%")),f.appendChild(t.CreateTableCell(Utilities.Format_Amount(i),"15%")),r.length>0?(f.appendChild(t.CreateTableCell(r,"25%")),f.appendChild(t.CreateTableCell(Utilities.Format_Amount(u),"15%"))):(f.appendChild(t.CreateTableCell("","25%")),f.appendChild(t.CreateTableCell("","15%"))),f}static BuildShortDJournalRow(n,i){let r=document.createElement("tr");return r.appendChild(t.CreateTableCellLink(n.Type,n.Code,"45%",i)),r.appendChild(t.CreateTableCell(Utilities.Format_Amount(n.TotalAmount),"15%")),r.appendChild(t.CreateTableCell(n.Type+" Deposits","25%")),r.appendChild(t.CreateTableCell(Utilities.Format_Amount(n.TotalAmount),"15%")),r}static BuildPaymentRow(n,i){let r=document.createElement("tr");return r.appendChild(t.CreateTableCellLink(n.Type,n.Code,"45%",i)),r.appendChild(t.CreateTableCell(Utilities.Format_Amount(n.TotalAmount),"15%")),r.appendChild(t.CreateTableCell("","25%")),r.appendChild(t.CreateTableCell("","15%")),r}static CreateTableCell(n,t){let i=document.createElement("td");return i.classList.add("has-text-right"),i.width=t,i.appendChild(document.createTextNode(n)),i}static CreateTableCellLink(i,r,u,f){let o=document.createElement("td");o.classList.add("has-text-right");o.width=u;let e=document.createElement("A");return e.onclick=()=>{Utilities.Set_Text(e,"loading...");let u="/",o="",s=window.location.pathname.toLowerCase().indexOf("/claypay");s==0&&(u="/claypay/");o="?DateToBalance="+f+"&PaymentType="+r;Utilities.Get(u+"API/Balancing/GetPayments"+o).then(function(r){console.log("payments",r);n.Payment.ShowPayments(r,i,f);Utilities.Hide(t.DJournalTotalsContainer);Utilities.Hide(t.DJournalReceiptContainer);Utilities.Set_Text(e,i);Utilities.Show(t.PaymentsContainer)},function(n){console.log("error getting payments for payment type: "+r,n);Utilities.Set_Text(e,i)})},e.appendChild(document.createTextNode(i)),o.appendChild(e),o}}t.DJournalTotalsContainer="djournalTotals";t.DJournalDateInput="djournalDate";t.DjournalContainer="balancingDJournal";t.PaymentsContainer="djournalPaymentsByType";t.DJournalReceiptContainer="djournalReceipt";n.DJournal=t}(Balancing||(Balancing={})),function(n){class t{constructor(){this.CreatedBy="";this.IsCreated=!1}}n.DJournalLog=t}(Balancing||(Balancing={})),function(n){function r(){t();n.DJournal.GetAndShow()}function t(){let n=document.getElementById("menuTabs");for(let t of i)n.appendChild(Utilities.Create_Menu_Element(t))}let i=[{id:"nav-balancing",title:"Balancing & DJournal Handling",subTitle:"Use this page to finalize a day's charges, or see if any payments are not balancing.",icon:"fas fa-home",label:"Balancing",selected:!0},{id:"nav-onlinePayments",title:"Online Payments Handling",subTitle:"The payments made online will be listed here.",icon:"fas fa-credit-card",label:"Online Payments",selected:!1},{id:"nav-receipts",title:"Receipts",subTitle:"You can use this to view a receipt.",icon:"fas fa-file",label:"Receipts",selected:!1}];n.Start=r;n.buildMenuElements=t}(Balancing||(Balancing={}));