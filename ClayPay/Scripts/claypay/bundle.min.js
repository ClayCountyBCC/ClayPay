var XHR,clayPay;(function(n){function u(n){var t=new r;return t.Headers=n.getAllResponseHeaders(),t.Text=n.responseText,t.Type=n.responseType,t.Status=n.status,t.StatusText=n.statusText,t}function t(n,t,i,r){return r===void 0&&(r=""),new Promise(function(f,e){var o=new XMLHttpRequest;o.open(n,t);i!=null&&i.forEach(function(n){return o.setRequestHeader(n.header,n.data)});o.onload=function(){(o.status<200||o.status>=300)&&e(u(o));f(u(o))};o.onerror=function(){e("There was an error communicating with the server.  Please check your connection and try again.")};r.length>0?o.send(r):o.send()})}function i(t){return t===null||t.length==0?t=[new n.Header("Content-Type","application/json; charset=utf-8"),new n.Header("Accept","application/json")]:(t.push(new n.Header("Content-Type","application/json; charset=utf-8")),t.push(new n.Header("Accept","application/json"))),t}function e(n,r,u){return r===void 0&&(r=null),u===void 0&&(u=!0),r=u?i(r):r,t("GET",n,r)}function o(n,r,u,f){return r===void 0&&(r=""),u===void 0&&(u=null),f===void 0&&(f=!0),u=f?i(u):u,t("POST",n,u,r)}function s(n,r,u,f){return r===void 0&&(r=""),u===void 0&&(u=null),f===void 0&&(f=!0),u=f?i(u):u,t("PUT",n,u,r)}function h(n,r,u,f){return r===void 0&&(r=""),u===void 0&&(u=null),f===void 0&&(f=!0),u=f?i(u):u,t("DELETE",n,u,r)}var f=function(){function n(n,t){this.header=n;this.data=t}return n}(),r;n.Header=f;r=function(){function n(){}return n}();n.Data=r;n.Get=e;n.Post=o;n.Put=s;n.Delete=h})(XHR||(XHR={}));
/*!
 * @overview es6-promise - a tiny implementation of Promises/A+.
 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
 * @license   Licensed under MIT license
 *            See https://raw.githubusercontent.com/jakearchibald/es6-promise/master/LICENSE
 * @version   3.2.2+35df15ea
 */
(function(){"use strict";function dt(n){return"function"==typeof n||"object"==typeof n&&null!==n}function rt(n){return"function"==typeof n}function gt(n){k=n}function ni(n){r=n}function ti(){return function(){process.nextTick(u)}}function ii(){return function(){lt(u)}}function ri(){var n=0,i=new wt(u),t=document.createTextNode("");return i.observe(t,{characterData:!0}),function(){t.data=n=++n%2}}function ui(){var n=new MessageChannel;return n.port1.onmessage=u,function(){n.port2.postMessage(0)}}function ut(){return function(){setTimeout(u,1)}}function u(){for(var t,i,n=0;e>n;n+=2)t=o[n],i=o[n+1],t(i),o[n]=void 0,o[n+1]=void 0;e=0}function fi(){try{var t=require,n=t("vertx");return lt=n.runOnLoop||n.runOnContext,ii()}catch(i){return ut()}}function ei(n,t){var e=this,i=new this.constructor(f),u,o;return void 0===i[v]&&ht(i),u=e._state,u?(o=arguments[u-1],r(function(){st(u,i,o,e._result)})):w(e,i,n,t),i}function oi(n){var i=this,t;return n&&"object"==typeof n&&n.constructor===i?n:(t=new i(f),c(t,n),t)}function f(){}function si(){return new TypeError("You cannot resolve a promise with itself")}function hi(){return new TypeError("A promises callback cannot return that same promise.")}function ft(n){try{return n.then}catch(t){return y.error=t,y}}function ci(n,t,i,r){try{n.call(t,i,r)}catch(u){return u}}function li(t,u,f){r(function(t){var r=!1,e=ci(f,u,function(n){r||(r=!0,u!==n?c(t,n):i(t,n))},function(i){r||(r=!0,n(t,i))},"Settle: "+(t._label||" unknown promise"));!r&&e&&(r=!0,n(t,e))},t)}function ai(t,r){r._state===a?i(t,r._result):r._state===h?n(t,r._result):w(r,void 0,function(n){c(t,n)},function(i){n(t,i)})}function et(t,r,u){r.constructor===t.constructor&&u===d&&constructor.resolve===g?ai(t,r):u===y?n(t,y.error):void 0===u?i(t,r):rt(u)?li(t,r,u):i(t,r)}function c(t,r){t===r?n(t,si()):dt(r)?et(t,r,ft(r)):i(t,r)}function vi(n){n._onerror&&n._onerror(n._result);b(n)}function i(n,t){n._state===s&&(n._result=t,n._state=a,0!==n._subscribers.length&&r(b,n))}function n(n,t){n._state===s&&(n._state=h,n._result=t,r(vi,n))}function w(n,t,i,u){var f=n._subscribers,e=f.length;n._onerror=null;f[e]=t;f[e+a]=i;f[e+h]=u;0===e&&n._state&&r(b,n)}function b(n){var i=n._subscribers,e=n._state,r,u,f,t;if(0!==i.length){for(f=n._result,t=0;t<i.length;t+=3)r=i[t],u=i[t+e],r?st(e,r,u,f):u(f);n._subscribers.length=0}}function ot(){this.error=null}function yi(n,t){try{return n(t)}catch(i){return nt.error=i,nt}}function st(t,r,u,f){var e,l,o,v,y=rt(u);if(y){if(e=yi(u,f),e===nt?(v=!0,l=e.error,e=null):o=!0,r===e)return void n(r,hi())}else e=f,o=!0;r._state!==s||(y&&o?c(r,e):v?n(r,l):t===a?i(r,e):t===h&&n(r,e))}function pi(t,i){try{i(function(n){c(t,n)},function(i){n(t,i)})}catch(r){n(t,r)}}function wi(){return bt++}function ht(n){n[v]=bt++;n._state=void 0;n._result=void 0;n._subscribers=[]}function bi(n){return new kt(this,n).promise}function ki(n){var t=this;return new t(vt(n)?function(i,r){for(var f=n.length,u=0;f>u;u++)t.resolve(n[u]).then(i,r)}:function(n,t){t(new TypeError("You must pass an array to race."))})}function di(t){var r=this,i=new r(f);return n(i,t),i}function gi(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor");}function nr(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");}function t(n){this[v]=wi();this._result=this._state=void 0;this._subscribers=[];f!==n&&("function"!=typeof n&&gi(),this instanceof t?pi(this,n):nr())}function l(t,r){this._instanceConstructor=t;this.promise=new t(f);this.promise[v]||ht(this.promise);vt(r)?(this._input=r,this.length=r.length,this._remaining=r.length,this._result=new Array(this.length),0===this.length?i(this.promise,this._result):(this.length=this.length||0,this._enumerate(),0===this._remaining&&i(this.promise,this._result))):n(this.promise,tr())}function tr(){return new Error("Array Methods must be provided an Array")}function ir(){var n,t;if("undefined"!=typeof global)n=global;else if("undefined"!=typeof self)n=self;else try{n=Function("return this")()}catch(i){throw new Error("polyfill failed because global object is unavailable in this environment");}t=n.Promise;(!t||"[object Promise]"!==Object.prototype.toString.call(t.resolve())||t.cast)&&(n.Promise=tt)}var ct,kt,it,p;ct=Array.isArray?Array.isArray:function(n){return"[object Array]"===Object.prototype.toString.call(n)};var lt,k,at,vt=ct,e=0,r=function(n,t){o[e]=n;o[e+1]=t;e+=2;2===e&&(k?k(u):at())},yt="undefined"!=typeof window?window:void 0,pt=yt||{},wt=pt.MutationObserver||pt.WebKitMutationObserver,rr="undefined"==typeof self&&"undefined"!=typeof process&&"[object process]"==={}.toString.call(process),ur="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,o=new Array(1e3);at=rr?ti():wt?ri():ur?ui():void 0===yt&&"function"==typeof require?fi():ut();var d=ei,g=oi,v=Math.random().toString(36).substring(16),s=void 0,a=1,h=2,y=new ot,nt=new ot,bt=0,fr=bi,er=ki,or=di,tt=t;t.all=fr;t.race=er;t.resolve=g;t.reject=or;t._setScheduler=gt;t._setAsap=ni;t._asap=r;t.prototype={constructor:t,then:d,"catch":function(n){return this.then(null,n)}};kt=l;l.prototype._enumerate=function(){for(var t=this.length,i=this._input,n=0;this._state===s&&t>n;n++)this._eachEntry(i[n],n)};l.prototype._eachEntry=function(n,t){var i=this._instanceConstructor,e=i.resolve,r,u;e===g?(r=ft(n),r===d&&n._state!==s?this._settledAt(n._state,t,n._result):"function"!=typeof r?(this._remaining--,this._result[t]=n):i===tt?(u=new i(f),et(u,n,r),this._willSettleAt(u,t)):this._willSettleAt(new i(function(t){t(n)}),t)):this._willSettleAt(e(n),t)};l.prototype._settledAt=function(t,r,u){var f=this.promise;f._state===s&&(this._remaining--,t===h?n(f,u):this._result[r]=u);0===this._remaining&&i(f,this._result)};l.prototype._willSettleAt=function(n,t){var i=this;w(n,void 0,function(n){i._settledAt(a,t,n)},function(n){i._settledAt(h,t,n)})};it=ir;p={Promise:tt,polyfill:it};"function"==typeof define&&define.amd?define(function(){return p}):"undefined"!=typeof module&&module.exports?module.exports=p:"undefined"!=typeof this&&(this.ES6Promise=p);it()}).call(this),function(n){"use strict";function t(){i()}function i(){f();u();r();n.UI.BuildCardTypes("ccTypes")}function r(){n.UI.BuildExpMonths("ccExpMonth");n.UI.BuildExpYears("ccExpYear")}function u(){n.transport.GetConvenienceFee().then(function(t){n.ConvenienceFee=t;console.log("conv fee is",t)},function(){console.log("error getting convenience fee")})}function f(){n.transport.GetApplicationTypes().then(function(t){n.UI.BuildAppTypes(t)},function(){console.log("error getting application types")})}function e(t){var r,i;for(n.UI.toggleNav("navTopMenu",t),r=document.getElementsByTagName("section"),i=0;i<r.length;i++)r[i].style.display!=="none"&&(r[i].style.display="none");document.getElementById(t).style.display="block"}n.start=t;n.toggleNavDisplay=e}(clayPay||(clayPay={})),function(n){var t;(function(n){"use strict";function t(){var n=XHR.Get("./API/Apptypes/");return new Promise(function(t,i){n.then(function(n){var i=JSON.parse(n.Text);t(i)}).catch(function(){console.log("error in Get Application Types");i(null)})})}function i(){var n=XHR.Get("./API/Fee/");return new Promise(function(t,i){n.then(function(n){var i=JSON.parse(n.Text);t(i)}).catch(function(){console.log("error in Get Convenience Fee");i(null)})})}function r(n){var t=XHR.Get("./API/Query/"+n);return new Promise(function(n,i){t.then(function(t){var i=JSON.parse(t.Text);n(i)}).catch(function(){console.log("error in Get Charges");i(null)})})}n.GetApplicationTypes=t;n.GetConvenienceFee=i;n.GetCharges=r})(t=n.transport||(n.transport={}))}(clayPay||(clayPay={})),function(n){var t;(function(t){"use strict";function it(){var s,h,i,e,t,c;return(ft("btnSubmit"),u("errorList"),u("PaymentPosting"),s=document.getElementById("paymentForm"),!s.checkValidity())?!1:(h=r.map(function(n){return n.ItemId}),i=r.reduce(function(n,t){return n+t.Total},0),i=parseFloat(i.toFixed(2)),e=new n.CCData(o("ccFirstName"),o("ccLastName"),o("cardNumber"),o("ccTypes"),o("ccExpMonth"),o("ccExpYear"),o("ccCVV"),o("ccZip"),o("emailAddress"),i,h),t=e.Validate(),t.length===0?(u("CCForm"),f("PaymentPosting"),c=e.Save(),c.then(function(n){var t=JSON.parse(n);rt();ut(t)},function(n){f("errorList");t=[n];w(t);f("CCForm");u("PaymentPosting");l("btnSubmit")})):(f("errorList"),w(t),l("btnSubmit")),!1)}function rt(){s=[];r=[];c();tt();var n=document.getElementById("paymentForm");n.reset();l("btnSubmit");f("CCForm");u("PaymentPosting")}function ut(t){n.toggleNavDisplay("receipt");y("receiptUniqueId",t.CashierId);y("receiptTimestamp",t.TimeStamp_Display);y("receiptAmount",t.Amount.toFixed(2))}function p(n,t){document.getElementById(n).disabled=t}function ft(n){p(n,!0)}function l(n){p(n,!1)}function w(n){var u=document.getElementById("errorList"),f=document.createDocumentFragment(),t,i,o,r;for(e(u),t=0,i=n;t<i.length;t++)o=i[t],r=document.createElement("li"),r.textContent=o,f.appendChild(r);u.appendChild(f)}function o(n){return document.getElementById(n).value}function et(n){var i=document.getElementById("ApplicationTypeSelect"),t,r,u;for(e(i),i.appendChild(h("-1","Select Application Type")),t=0,r=n;t<r.length;t++)u=r[t],i.appendChild(h(u.Value,u.Label))}function ot(n){var t=document.getElementById(n);e(t);[{label:"American Express",value:"AMEX"},{label:"Discover",value:"DISCOVER"},{label:"MasterCard",value:"MASTERCARD"},{label:"Visa",value:"VISA"}].map(function(n){t.appendChild(h(n.value,n.label))})}function st(n){var i=document.getElementById(n);i!==undefined&&(e(i),t.ExpMonths.map(function(n){i.appendChild(h(n,n))}))}function ht(n){var u=document.getElementById(n),f,i,r;for(e(u),f=(new Date).getFullYear(),i=0;i<10;i++)r=(f+i).toString(),u.appendChild(h(r,r)),t.ExpYears.push(r)}function h(n,t){var i=document.createElement("option");return i.setAttribute("value",n),i.appendChild(document.createTextNode(t)),i}function e(n){while(n.firstChild)n.removeChild(n.firstChild)}function ct(n,t){var f=document.getElementById(n),r,i,u;if(f!==null){for(r=f.getElementsByClassName("active"),i=0;i<r.length;i++)r[i].classList.remove("active");(u=document.getElementById("nav-"+t),u!==null)&&u.classList.add("active")}}function f(n){var t=document.getElementById(n);t.style.display="block"}function u(n){var t=document.getElementById(n);t.style.display="none"}function lt(t){u("InvalidSearch");u("SearchFailed");u("SearchSuccessful");f("SearchResults");f("Searching");var i=t.trim().toUpperCase();if(i.length>0)n.transport.GetCharges(i).then(function(n){return s=n,u("Searching"),at(n,t),!0},function(){return console.log("error getting charges"),u("Searching"),!1});else return u("Searching"),f("InvalidSearch"),!1}function at(n,t){b(n);n.length==0?bt(t):(f("SearchSuccessful"),nt("ChargesKey",n[0].AssocKey),nt("ChargesDetail",n[0].Detail))}function b(n){var u=document.getElementById("Charges"),i=document.createDocumentFragment(),t,r,f;for(e(u),t=0,r=n;t<r.length;t++)f=r[t],i.appendChild(yt(f));i.appendChild(vt());u.appendChild(i)}function vt(){var r=document.createDocumentFragment(),u=document.createElement("tr"),t;return u.appendChild(i("","",3)),u.appendChild(v("Add All to Cart",0,"",!0,pt,a)),r.appendChild(u),t=document.createElement("tr"),t.appendChild(i("","",3)),t.appendChild(wt("View Cart",n.toggleNavDisplay)),r.appendChild(t),r}function yt(n){var t=document.createElement("tr");return t.appendChild(i(n.Description,"left")),t.appendChild(i(n.TimeStampDisplay)),t.appendChild(i(n.Total.toFixed(2))),t.appendChild(v("Add to Cart",n.ItemId,"",!0,k,a)),t}function k(n,t){var i=s.filter(function(n){return n.ItemId==t});i.length===1&&r.indexOf(i[0])===-1&&r.push(i[0]);d(t);c()}function a(n,t,i){var u=r.filter(function(n){return n.ItemId!==t});r=u;i&&d(t);c()}function d(n){var t=document.getElementById("btnAdd"+n.toString()),r=document.getElementById("btnRemove"+n.toString()),i=t.style.display==="inline-block";t.style.display=i?"none":"inline-block";r.style.display=i?"inline-block":"none"}function g(n){var t=r.filter(function(t){return t.ItemId==n});return t.length!==0}function pt(){for(var i,n=0,t=s;n<t.length;n++)i=t[n],g(i.ItemId)||r.push(i);c();b(s)}function i(n,t,i){var r=document.createElement("td");return t!==undefined&&(r.className=t),i!==undefined&&(r.colSpan=i),r.appendChild(document.createTextNode(n)),r}function v(n,t,i,r,u,f){var c=g(t),h=document.createElement("td"),e,o,s;return h.className=i,e=document.createElement("button"),e.style.display=c?"none":"inline-block",e.type="button",e.id="btnAdd"+t.toString(),e.className="btn btn-primary",e.onclick=function(n){u(n,t)},o=document.createElement("div"),o.id="btnRemove"+t.toString(),o.style.display=c?"inline-block":"none",o.appendChild(document.createTextNode("Added (")),s=document.createElement("a"),s,s.style.color="darkgoldenrod",s.style.cursor="pointer",s.appendChild(document.createTextNode("remove")),s.onclick=function(n){f(n,t,r)},o.appendChild(s),o.appendChild(document.createTextNode(")")),e.appendChild(document.createTextNode(n)),h.appendChild(e),h.appendChild(o),h}function wt(n,t){var r=document.createElement("td"),i=document.createElement("button");return i.type="button",i.className="btn btn-success",i.onclick=function(){t("cart")},i.appendChild(document.createTextNode(n)),r.appendChild(i),r}function y(n,t){var i=document.getElementById(n);i.value=t}function nt(n,t){var i=document.getElementById(n);e(i);i.appendChild(document.createTextNode(t))}function bt(n){var i=document.getElementById("SearchFailed"),t;e(i);t=document.createElement("h4");t.appendChild(document.createTextNode("No charges were found for search: "+n));i.appendChild(t);f("SearchFailed")}function tt(){var n=document.getElementById("CartNav"),t,i;e(n);t=document.createElement("span");t.classList.add("glyphicon");t.classList.add("glyphicon-shopping-cart");n.appendChild(t);r.length===0?(u("CartNotEmpty"),f("CartEmpty"),n.appendChild(document.createTextNode("Cart: (")),i=document.createElement("span"),i.style.color="darkgoldenrod",i.appendChild(document.createTextNode("empty")),n.appendChild(i),n.appendChild(document.createTextNode(")"))):(f("CartNotEmpty"),u("CartEmpty"),n.appendChild(document.createTextNode("Cart: "+r.length.toString()+(r.length===1?" item":" items"))))}function c(){var u=document.getElementById("CartCharges"),n=document.createDocumentFragment(),t,i,f;for(e(u),t=0,i=r;t<i.length;t++)f=i[t],n.appendChild(gt(f));n.appendChild(kt());n.appendChild(dt());u.appendChild(n);tt()}function kt(){var n=document.createElement("tr"),t;return n.style.fontWeight="bolder",n.appendChild(i("","",2)),n.appendChild(i("Total","center",1)),t=r.reduce(function(n,t){return n+t.Total},0),n.appendChild(i(t.toFixed(2),"",1)),n.appendChild(i("","",1)),n}function dt(){var t=document.createElement("tr");return t.style.fontWeight="bolder",t.appendChild(i("Please Note: There is a nonrefundable transaction fee charged by our payment provider. This is charged in addition to the total above.","",2)),t.appendChild(i("Conv. Fee","center",1)),t.appendChild(i(n.ConvenienceFee,"",1)),t.appendChild(i("","",1)),t}function gt(n){var t=document.createElement("tr");return t.appendChild(i(n.AssocKey)),t.appendChild(i(n.Description,"left")),t.appendChild(i(n.TimeStampDisplay,"center")),t.appendChild(i(n.Total.toFixed(2),"center")),t.appendChild(v("Add to Cart",n.ItemId,"center",!0,k,a)),t}var r=[],s=[];t.ExpMonths=["01","02","03","04","05","06","07","08","09","10","11","12"];t.ExpYears=[];t.Submit=it;t.BuildAppTypes=et;t.BuildCardTypes=ot;t.BuildExpMonths=st;t.BuildExpYears=ht;t.clearElement=e;t.toggleNav=ct;t.Search=lt})(t=n.UI||(n.UI={}))}(clayPay||(clayPay={})),function(n){var t=function(){function t(n,t,i,r,u,f,e,o,s,h,c){this.FirstName=n;this.LastName=t;this.CardNumber=i;this.CardType=r;this.ExpMonth=u;this.ExpYear=f;this.CVVNumber=e;this.ZipCode=o;this.EmailAddress=s;this.Total=h;this.ItemIds=c}return t.prototype.Validate=function(){var t=[],i;if(this.FirstName=this.FirstName.trim(),this.FirstName.length===0&&t.push("You must enter a First Name."),this.LastName=this.LastName.trim(),this.LastName.length===0&&t.push("You must enter a Last Name."),this.CardNumber=this.CardNumber.trim(),this.CardNumber.length===0&&t.push("You must enter a Card number."),this.CVVNumber=this.CVVNumber.trim(),this.CVVNumber.length===0&&t.push("You must enter a CVC number."),this.ZipCode=this.ZipCode.trim(),this.ZipCode.length===0&&t.push("You must enter a Zip Code."),this.EmailAddress=this.EmailAddress.trim(),this.EmailAddress.length===0&&t.push("You must enter an Email Address."),(this.ItemIds===null||this.ItemIds.length===0)&&t.push("No items were found in the cart.  Please check this and try again."),i=["AMEX","DISCOVER","MASTERCARD","VISA"],i.indexOf(this.CardType)===-1&&t.push("An invalid Credit Card Type has been selected."),n.UI.ExpMonths.indexOf(this.ExpMonth)===-1&&t.push("An invalid Expiration Month has been selected."),n.UI.ExpYears.indexOf(this.ExpYear)===-1&&t.push("An invalid Expiration Year has been selected."),n.UI.ExpMonths.indexOf(this.ExpMonth)!==-1&&n.UI.ExpYears.indexOf(this.ExpYear)!==-1){var u=parseInt(this.ExpYear),f=parseInt(this.ExpMonth),e=new Date(u,f-1,1),r=new Date,o=new Date(r.getFullYear(),r.getMonth(),1);e<o&&t.push("The expiration date entered has passed.  Please check it and try again.")}return t},t.prototype.Save=function(){var n=this;return new Promise(function(t,i){if(n.Validate().length>0)return i(!1);var r=XHR.Put("./API/Pay",JSON.stringify(n));r.then(function(n){return t(n.Text)},function(n){return n.Text.toLowerCase().indexOf("message")?i(JSON.parse(n.Text).Message):i(n.Text)})})},t}();n.CCData=t}(clayPay||(clayPay={})),function(n){var t=function(){function n(){this.ItemId=0;this.Description="";this.TimeStampDisplay=""}return n}();n.Charge=t}(clayPay||(clayPay={}));