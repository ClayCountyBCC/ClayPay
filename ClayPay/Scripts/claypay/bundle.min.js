var Utilities,clayPay;(function(n,t){typeof exports=="object"&&typeof module!="undefined"?t():typeof define=="function"&&define.amd?define(t):t()})(this,function(){"use strict";function s(){}function h(n,t){return function(){n.apply(t,arguments)}}function n(t){if(!(this instanceof n))throw new TypeError("Promises must be constructed via new");if(typeof t!="function")throw new TypeError("not a function");this._state=0;this._handled=!1;this._value=undefined;this._deferreds=[];e(t,this)}function f(r,u){while(r._state===3)r=r._value;if(r._state===0){r._deferreds.push(u);return}r._handled=!0;n._immediateFn(function(){var n=r._state===1?u.onFulfilled:u.onRejected,f;if(n===null){(r._state===1?i:t)(u.promise,r._value);return}try{f=n(r._value)}catch(e){t(u.promise,e);return}i(u.promise,f)})}function i(i,u){try{if(u===i)throw new TypeError("A promise cannot be resolved with itself.");if(u&&(typeof u=="object"||typeof u=="function")){var f=u.then;if(u instanceof n){i._state=3;i._value=u;r(i);return}if(typeof f=="function"){e(h(f,u),i);return}}i._state=1;i._value=u;r(i)}catch(o){t(i,o)}}function t(n,t){n._state=2;n._value=t;r(n)}function r(t){t._state===2&&t._deferreds.length===0&&n._immediateFn(function(){t._handled||n._unhandledRejectionFn(t._value)});for(var i=0,r=t._deferreds.length;i<r;i++)f(t,t._deferreds[i]);t._deferreds=null}function c(n,t,i){this.onFulfilled=typeof n=="function"?n:null;this.onRejected=typeof t=="function"?t:null;this.promise=i}function e(n,r){var u=!1;try{n(function(n){u||(u=!0,i(r,n))},function(n){u||(u=!0,t(r,n))})}catch(f){if(u)return;u=!0;t(r,f)}}var o=setTimeout,u;n.prototype["catch"]=function(n){return this.then(null,n)};n.prototype.then=function(n,t){var i=new this.constructor(s);return f(this,new c(n,t,i)),i};n.prototype["finally"]=function(n){var t=this.constructor;return this.then(function(i){return t.resolve(n()).then(function(){return i})},function(i){return t.resolve(n()).then(function(){return t.reject(i)})})};n.all=function(t){return new n(function(n,i){function e(t,u){try{if(u&&(typeof u=="object"||typeof u=="function")){var o=u.then;if(typeof o=="function"){o.call(u,function(n){e(t,n)},i);return}}r[t]=u;--f==0&&n(r)}catch(s){i(s)}}var r,f,u;if(!t||typeof t.length=="undefined")throw new TypeError("Promise.all accepts an array");if(r=Array.prototype.slice.call(t),r.length===0)return n([]);for(f=r.length,u=0;u<r.length;u++)e(u,r[u])})};n.resolve=function(t){return t&&typeof t=="object"&&t.constructor===n?t:new n(function(n){n(t)})};n.reject=function(t){return new n(function(n,i){i(t)})};n.race=function(t){return new n(function(n,i){for(var r=0,u=t.length;r<u;r++)t[r].then(n,i)})};n._immediateFn=typeof setImmediate=="function"&&function(n){setImmediate(n)}||function(n){o(n,0)};n._unhandledRejectionFn=function(n){typeof console!="undefined"&&console&&console.warn("Possible Unhandled Promise Rejection:",n)};u=function(){if(typeof self!="undefined")return self;if(typeof window!="undefined")return window;if(typeof global!="undefined")return global;throw new Error("unable to locate global object");}();u.Promise||(u.Promise=n)}),function(n){"use strict";function f(n){if(typeof n!="string"&&(n=String(n)),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(n))throw new TypeError("Invalid character in header field name");return n.toLowerCase()}function s(n){return typeof n!="string"&&(n=String(n)),n}function e(n){var t={next:function(){var t=n.shift();return{done:t===undefined,value:t}}};return i.iterable&&(t[Symbol.iterator]=function(){return t}),t}function t(n){this.map={};n instanceof t?n.forEach(function(n,t){this.append(t,n)},this):Array.isArray(n)?n.forEach(function(n){this.append(n[0],n[1])},this):n&&Object.getOwnPropertyNames(n).forEach(function(t){this.append(t,n[t])},this)}function o(n){if(n.bodyUsed)return Promise.reject(new TypeError("Already read"));n.bodyUsed=!0}function h(n){return new Promise(function(t,i){n.onload=function(){t(n.result)};n.onerror=function(){i(n.error)}})}function b(n){var t=new FileReader,i=h(t);return t.readAsArrayBuffer(n),i}function k(n){var t=new FileReader,i=h(t);return t.readAsText(n),i}function d(n){for(var i=new Uint8Array(n),r=new Array(i.length),t=0;t<i.length;t++)r[t]=String.fromCharCode(i[t]);return r.join("")}function c(n){if(n.slice)return n.slice(0);var t=new Uint8Array(n.byteLength);return t.set(new Uint8Array(n)),t.buffer}function l(){return this.bodyUsed=!1,this._initBody=function(n){if(this._bodyInit=n,n)if(typeof n=="string")this._bodyText=n;else if(i.blob&&Blob.prototype.isPrototypeOf(n))this._bodyBlob=n;else if(i.formData&&FormData.prototype.isPrototypeOf(n))this._bodyFormData=n;else if(i.searchParams&&URLSearchParams.prototype.isPrototypeOf(n))this._bodyText=n.toString();else if(i.arrayBuffer&&i.blob&&p(n))this._bodyArrayBuffer=c(n.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer]);else if(i.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(n)||w(n)))this._bodyArrayBuffer=c(n);else throw new Error("unsupported BodyInit type");else this._bodyText="";this.headers.get("content-type")||(typeof n=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):i.searchParams&&URLSearchParams.prototype.isPrototypeOf(n)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},i.blob&&(this.blob=function(){var n=o(this);if(n)return n;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");else return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?o(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(b)}),this.text=function(){var n=o(this);if(n)return n;if(this._bodyBlob)return k(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(d(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");else return Promise.resolve(this._bodyText)},i.formData&&(this.formData=function(){return this.text().then(nt)}),this.json=function(){return this.text().then(JSON.parse)},this}function g(n){var t=n.toUpperCase();return a.indexOf(t)>-1?t:n}function u(n,i){i=i||{};var r=i.body;if(n instanceof u){if(n.bodyUsed)throw new TypeError("Already read");this.url=n.url;this.credentials=n.credentials;i.headers||(this.headers=new t(n.headers));this.method=n.method;this.mode=n.mode;r||n._bodyInit==null||(r=n._bodyInit,n.bodyUsed=!0)}else this.url=String(n);if(this.credentials=i.credentials||this.credentials||"omit",(i.headers||!this.headers)&&(this.headers=new t(i.headers)),this.method=g(i.method||this.method||"GET"),this.mode=i.mode||this.mode||null,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&r)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(r)}function nt(n){var t=new FormData;return n.trim().split("&").forEach(function(n){if(n){var i=n.split("="),r=i.shift().replace(/\+/g," "),u=i.join("=").replace(/\+/g," ");t.append(decodeURIComponent(r),decodeURIComponent(u))}}),t}function tt(n){var i=new t,r=n.replace(/\r?\n[\t ]+/g," ");return r.split(/\r?\n/).forEach(function(n){var t=n.split(":"),r=t.shift().trim(),u;r&&(u=t.join(":").trim(),i.append(r,u))}),i}function r(n,i){i||(i={});this.type="default";this.status=i.status===undefined?200:i.status;this.ok=this.status>=200&&this.status<300;this.statusText="statusText"in i?i.statusText:"OK";this.headers=new t(i.headers);this.url=i.url||"";this._initBody(n)}var i,a,v;if(!n.fetch){if(i={searchParams:"URLSearchParams"in n,iterable:"Symbol"in n&&"iterator"in Symbol,blob:"FileReader"in n&&"Blob"in n&&function(){try{return new Blob,!0}catch(n){return!1}}(),formData:"FormData"in n,arrayBuffer:"ArrayBuffer"in n},i.arrayBuffer)var y=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],p=function(n){return n&&DataView.prototype.isPrototypeOf(n)},w=ArrayBuffer.isView||function(n){return n&&y.indexOf(Object.prototype.toString.call(n))>-1};t.prototype.append=function(n,t){n=f(n);t=s(t);var i=this.map[n];this.map[n]=i?i+","+t:t};t.prototype["delete"]=function(n){delete this.map[f(n)]};t.prototype.get=function(n){return n=f(n),this.has(n)?this.map[n]:null};t.prototype.has=function(n){return this.map.hasOwnProperty(f(n))};t.prototype.set=function(n,t){this.map[f(n)]=s(t)};t.prototype.forEach=function(n,t){for(var i in this.map)this.map.hasOwnProperty(i)&&n.call(t,this.map[i],i,this)};t.prototype.keys=function(){var n=[];return this.forEach(function(t,i){n.push(i)}),e(n)};t.prototype.values=function(){var n=[];return this.forEach(function(t){n.push(t)}),e(n)};t.prototype.entries=function(){var n=[];return this.forEach(function(t,i){n.push([i,t])}),e(n)};i.iterable&&(t.prototype[Symbol.iterator]=t.prototype.entries);a=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];u.prototype.clone=function(){return new u(this,{body:this._bodyInit})};l.call(u.prototype);l.call(r.prototype);r.prototype.clone=function(){return new r(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new t(this.headers),url:this.url})};r.error=function(){var n=new r(null,{status:0,statusText:""});return n.type="error",n};v=[301,302,303,307,308];r.redirect=function(n,t){if(v.indexOf(t)===-1)throw new RangeError("Invalid status code");return new r(null,{status:t,headers:{location:n}})};n.Headers=t;n.Request=u;n.Response=r;n.fetch=function(n,t){return new Promise(function(f,e){var s=new u(n,t),o=new XMLHttpRequest;o.onload=function(){var n={status:o.status,statusText:o.statusText,headers:tt(o.getAllResponseHeaders()||"")},t;n.url="responseURL"in o?o.responseURL:n.headers.get("X-Request-URL");t="response"in o?o.response:o.responseText;f(new r(t,n))};o.onerror=function(){e(new TypeError("Network request failed"))};o.ontimeout=function(){e(new TypeError("Network request failed"))};o.open(s.method,s.url,!0);s.credentials==="include"?o.withCredentials=!0:s.credentials==="omit"&&(o.withCredentials=!1);"responseType"in o&&i.blob&&(o.responseType="blob");s.headers.forEach(function(n,t){o.setRequestHeader(t,n)});o.send(typeof s._bodyInit=="undefined"?null:s._bodyInit)})};n.fetch.polyfill=!0}}(typeof self!="undefined"?self:this),function(n){function t(n){typeof n=="string"&&(n=document.getElementById(n));n.classList.add("hide");n.classList.remove("show");n.classList.remove("show-inline");n.classList.remove("show-flex")}function i(n){typeof n=="string"&&(n=document.getElementById(n));n.classList.add("show");n.classList.remove("hide");n.classList.remove("show-inline");n.classList.remove("show-flex")}function c(n){typeof n=="string"&&(n=document.getElementById(n));n.classList.add("show-inline");n.classList.remove("hide");n.classList.remove("show");n.classList.remove("show-flex")}function l(n){typeof n=="string"&&(n=document.getElementById(n));n.classList.add("show-flex");n.classList.remove("hide");n.classList.remove("show-inline");n.classList.remove("show")}function f(n,u,f){var e,o,s;typeof n=="string"&&(n=document.getElementById(n));u&&(r(n),e=document.createElement("div"),e.classList.add("notification"),e.classList.add("is-danger"),o=document.createElement("button"),o.classList.add("delete"),o.onclick=function(){t(n)},e.appendChild(o),Array.isArray(u)?(s=document.createElement("ul"),u.forEach(function(n){var t=document.createElement("li");t.appendChild(document.createTextNode(n));s.appendChild(t)}),e.appendChild(s)):e.appendChild(document.createTextNode(u)),n.appendChild(e));i(n);(f==undefined||f===!0)&&window.setTimeout(function(){t(n)},1e4)}function r(n){if(n!==null&&n!==undefined)while(n.firstChild)n.removeChild(n.firstChild)}function a(n,t,i){i===void 0&&(i=!1);var r=document.createElement("option");return r.value=n,r.text=t,r.selected=i,r}function e(n){return typeof n=="string"&&(n=document.getElementById(n)),n.value}function v(n,t){typeof n=="string"&&(n=document.getElementById(n));n.value=t}function u(n,t){typeof n=="string"&&(n=document.getElementById(n));r(n);n.appendChild(document.createTextNode(t))}function o(n){var u=n.replace("nav-",""),r=document.querySelectorAll("#menuTabs > li > a"),t,i;if(r.length>0)for(t=0;t<r.length;t++)i=r.item(t),i.id===n?i.parentElement.classList.add("is-active"):i.parentElement.classList.remove("is-active");s("#views > section",u)}function s(n,r){var e=document.querySelectorAll(n),u,f;if(e.length>0)for(u=0;u<e.length;u++)f=e.item(u),f.id===r?i(f):t(f)}function y(n){return fetch(n,{method:"GET",headers:{"Content-Type":"application/json"},cache:"no-cache",credentials:"include"}).then(function(n){if(!n.ok)throw new Error(n.statusText);return n.json()})}function p(n,t){return fetch(n,{method:"POST",body:JSON.stringify(t),cache:"no-cache",headers:{"Content-Type":"application/json"},credentials:"include"}).then(function(n){if(console.log("Post Response",n),!n.ok)throw new Error(n.statusText);return n.json()})}function w(n){return n.toLocaleString("en-US",{style:"currency",currency:"USD"})}function b(n){return n instanceof Date?n.toLocaleDateString("en-us"):new Date(n).toLocaleString("en-US")}function k(n,t,i){var r,u;return(typeof n=="string"&&(n=document.getElementById(n)),r=n,r.tagName.toLowerCase()==="select"?r.parentElement.classList.remove("is-danger"):r.classList.remove("is-danger"),u=e(r).trim(),u.length==0)?(r.tagName.toLowerCase()==="select"?r.parentElement.classList.add("is-danger"):r.classList.add("is-danger"),f(t,i),r.focus(),r.scrollTo(),""):u}function d(n,t){typeof n=="string"&&(n=document.getElementById(n));var i=n;i.disabled=t;i.classList.toggle("is-loading",t)}function g(n){var u=document.createElement("li"),t,i,f,o,r,e,s;if(n.selected&&u.classList.add("is-active"),t=document.createElement("a"),t.id=n.id,t.href="#",t.onclick=function(){h(n)},n.icon.length>0){for(i=document.createElement("span"),i.classList.add("icon"),i.classList.add("is-medium"),f=document.createElement("i"),o=n.icon.split(" "),r=0,e=o;r<e.length;r++)s=e[r],f.classList.add(s);i.appendChild(f);t.appendChild(i)}return t.appendChild(document.createTextNode(n.label)),u.appendChild(t),u}function h(n){u("menuTitle",n.title);u("menuSubTitle",n.subTitle);o(n.id)}function nt(){return(navigator.userAgent.indexOf("Opera")||navigator.userAgent.indexOf("OPR"))!=-1?"Opera":navigator.userAgent.indexOf("Chrome")!=-1?"Chrome":navigator.userAgent.indexOf("Safari")!=-1?"Safari":navigator.userAgent.indexOf("Firefox")!=-1?"Firefox":navigator.userAgent.indexOf("MSIE")!=-1||!!document.DOCUMENT_NODE==!0?"IE":"unknown"}n.Hide=t;n.Show=i;n.Show_Inline=c;n.Show_Flex=l;n.Error_Show=f;n.Clear_Element=r;n.Create_Option=a;n.Get_Value=e;n.Set_Value=v;n.Set_Text=u;n.Show_Menu=o;n.Show_Hide_Selector=s;n.Get=y;n.Post=p;n.Format_Amount=w;n.Format_Date=b;n.Validate_Text=k;n.Toggle_Loading_Button=d;n.Create_Menu_Element=g;n.Update_Menu=h;n.CheckBrowser=nt}(Utilities||(Utilities={})),function(n){var t=function(){function n(){this.PayerFirstName="";this.PayerLastName="";this.PayerName="";this.PayerPhoneNumber="";this.PayerEmailAddress="";this.PayerCompanyName="";this.PayerStreetAddress="";this.PayerStreet1="";this.PayerStreet2="";this.PayerCity="";this.PayerState="";this.PayerZip="";this.UserName="";this.TransactionDate=new Date;this.IsVoided=!1}return n.prototype.ValidatePayer=function(){var t;return(this.ResetPayerData(),this.PayerFirstName=Utilities.Validate_Text(n.payerFirstName,n.payerNameError,"The Firstname field is required."),this.PayerFirstName.length===0)?!1:(this.PayerLastName=Utilities.Validate_Text(n.payerLastName,n.payerNameError,"The Lastname field is required."),this.PayerLastName.length===0)?!1:(this.PayerPhoneNumber=Utilities.Validate_Text(n.payerPhone,n.payerPhoneError,"The Phone number field is required."),this.PayerPhoneNumber.length===0)?!1:this.PayerPhoneNumber.length<10?(Utilities.Error_Show(n.payerPhoneError,"The Phone Number should include area code and a 7 digit number."),t=document.getElementById(n.payerPhone),t.classList.add("is-danger"),t.focus(),t.scrollTo(),!1):(this.PayerEmailAddress=Utilities.Get_Value(n.payerEmail).trim(),this.PayerCompanyName=Utilities.Get_Value(n.payerCompany).trim(),this.PayerStreetAddress=Utilities.Validate_Text(n.payerStreet,n.payerStreetError,"The street address field is required."),this.PayerStreetAddress.length===0)?!1:(this.PayerCity=this.PayerState=Utilities.Get_Value(n.payerCity).trim(),this.PayerState=Utilities.Get_Value(n.payerState).trim(),this.PayerZip=Utilities.Validate_Text(n.payerZip,n.payerCityError,"You must enter a Zip code of at least 5 digits."),this.PayerZip.length===0)?!1:this.PayerZip.length<5?(Utilities.Error_Show(n.payerCityError,"You must enter a Zip code of at least 5 digits."),t=document.getElementById(n.payerZip),t.classList.add("is-danger"),t.focus(),t.scrollTo(),!1):!0},n.prototype.ResetPayerForm=function(){Utilities.Set_Value(n.payerCity,"");Utilities.Set_Value(n.payerCompany,"");Utilities.Set_Value(n.payerFirstName,"");Utilities.Set_Value(n.payerLastName,"");Utilities.Set_Value(n.payerPhone,"");Utilities.Set_Value(n.payerEmail,"");Utilities.Set_Value(n.payerStreet,"");document.getElementById(n.payerState).selectedIndex=0},n.prototype.ResetPayerData=function(){this.PayerFirstName="";this.PayerLastName="";this.PayerPhoneNumber="";this.PayerEmailAddress="";this.PayerCompanyName="";this.PayerState="";this.PayerCity="";this.PayerStreetAddress="";this.PayerZip=""},n.payerFirstName="payerFirstName",n.payerLastName="payerLastName",n.payerPhone="payerPhone",n.payerEmail="payerEmailAddress",n.payerCompany="payerCompany",n.payerStreet="payerStreetAddress",n.payerCity="payerCity",n.payerState="payerState",n.payerZip="payerZip",n.payerNameError="payerNameError",n.payerPhoneError="payerPhoneError",n.payerStreetError="payerStreetError",n.payerCityError="payerCityError",n}();n.CashierData=t}(clayPay||(clayPay={})),function(n){var t=function(){function n(n){var r,i,t;for(this.Permit="",this.CashierId="",this.ContractorId="",this.ApplicationNumber="",r=n.split("&"),i=0;i<r.length;i++){t=r[i].split("=");switch(t[0].toLowerCase()){case"application":this.ApplicationNumber=t[1];break;case"contractor":this.ContractorId=t[1];break;case"permit":this.Permit=t[1];break;case"cashierid":this.CashierId=t[1]}}}return n.prototype.ToHash=function(){var n="";return this.Permit.length>0&&(n+="&permit="+this.Permit),this.ApplicationNumber.length>0&&(n+="&application="+this.ApplicationNumber),this.ContractorId.length>0&&(n+="&contractor="+this.ContractorId),this.CashierId.length>0&&(n+="&cashierid="+this.CashierId),n.length>0&&(n="#"+n.substring(1)),n},n}();n.LocationHash=t}(clayPay||(clayPay={})),function(n){var t,i;(function(n){n[n.search_results=0]="search_results";n[n.cart=1]="cart";n[n.receipt=2]="receipt"})(t=n.ChargeView||(n.ChargeView={}));i=function(){function i(){this.ItemId=0;this.Description="";this.TimeStampDisplay=""}return i.CreateTable=function(i){var u=document.createElement("table"),f,r;return u.classList.add("table"),u.classList.add("is-fullwidth"),f=document.createElement("THEAD"),r=document.createElement("tr"),r.appendChild(n.UI.createTableHeaderElement("Key","20%")),i!==t.receipt?(r.appendChild(n.UI.createTableHeaderElement("Description","40%")),r.appendChild(n.UI.createTableHeaderElement("Date","15%")),r.appendChild(n.UI.createTableHeaderElement("Amount","15%")),r.appendChild(n.UI.createTableHeaderElement("","10%"))):(r.appendChild(n.UI.createTableHeaderElement("Description","50%")),r.appendChild(n.UI.createTableHeaderElement("Amount","30%"))),f.appendChild(r),u.appendChild(f),u},i.CreateChargesTable=function(n,t){var f=document.createDocumentFragment(),r=i.CreateTable(t),e=document.createElement("TBODY"),u;return n.forEach(function(n){e.appendChild(i.buildChargeRow(n,t))}),u=document.createElement("TFOOT"),u.appendChild(i.buildChargeFooterRow(n,t)),r.appendChild(e),r.appendChild(u),f.appendChild(r),f},i.buildChargeFooterRow=function(r,u){var e=document.createDocumentFragment(),f=document.createElement("tr"),o;f.appendChild(n.UI.createTableElement("","",u===t.receipt?1:2));f.appendChild(n.UI.createTableElement("Total","has-text-weight-bold has-text-right",1));o=r.reduce(function(n,t){return n+t.Total},0);f.appendChild(n.UI.createTableElement(Utilities.Format_Amount(o),""));u===t.search_results?f.appendChild(i.createAddAllChargesToCartButton()):u!==t.receipt&&f.appendChild(n.UI.createTableElement("","",1));e.appendChild(f);switch(u){case t.search_results:e.appendChild(i.createViewCartFooterRow());break;case t.cart:n.CurrentTransaction.TotalAmountDue=o;n.CurrentTransaction.UpdateTotals();e.appendChild(i.buildConvFeeFooterRow())}return e},i.buildConvFeeFooterRow=function(){var t=document.createElement("tr");return t.style.fontWeight="bolder",t.appendChild(n.UI.createTableElement("There is a nonrefundable transaction fee charged for Credit Card Payments by our payment provider. This is charged in addition to the total above.","",2)),t.appendChild(n.UI.createTableElement("Conv. Fee","center",1)),t.appendChild(n.UI.createTableElement(n.ConvenienceFee,"",1)),t.appendChild(n.UI.createTableElement("","",1)),t},i.buildChargeRow=function(r,u){var f=document.createElement("tr");return f.appendChild(n.UI.createTableElement(r.AssocKey)),f.appendChild(n.UI.createTableElement(r.Description,"left")),u!==t.receipt&&f.appendChild(n.UI.createTableElement(r.TimeStampDisplay,"center")),f.appendChild(n.UI.createTableElement(Utilities.Format_Amount(r.Total),"center")),u!==t.receipt&&f.appendChild(i.createChargeCartButtonToggle("Add to Cart",r.ItemId,"center",!0)),f},i.createAddAllChargesToCartButton=function(){var i=document.createElement("td"),t=document.createElement("button");return t.type="button",t.classList.add("button"),t.classList.add("is-primary"),t.appendChild(document.createTextNode("Add All To Cart")),t.onclick=function(){for(var r,t=0,i=n.CurrentTransaction.CurrentCharges;t<i.length;t++)r=i[t],n.UI.IsItemInCart(r.ItemId)||n.CurrentTransaction.Cart.push(r);n.UI.updateCart();n.UI.ProcessSearchResults(n.CurrentTransaction.CurrentCharges)},i.appendChild(t),i},i.createChargeCartButtonToggle=function(t,i,r){var e=document.createElement("a"),f=document.createElement("div"),u=document.createElement("button"),s=n.UI.IsItemInCart(i),o=document.createElement("td");return o.className=r,u.style.display=s?"none":"inline-block",u.type="button",u.className="button is-primary",u.onclick=function(){var t=n.CurrentTransaction.CurrentCharges.filter(function(n){return n.ItemId==i});t.length===1&&n.CurrentTransaction.Cart.indexOf(t[0])===-1&&n.CurrentTransaction.Cart.push(t[0]);f.style.display="inline-block";u.style.display="none";n.UI.updateCart()},f.style.display=s?"inline-block":"none",f.appendChild(document.createTextNode("Added (")),e.classList.add("is-warning"),e.style.cursor="pointer",e.appendChild(document.createTextNode("remove")),e.onclick=function(){var t=n.CurrentTransaction.Cart.filter(function(n){return n.ItemId!==i});n.CurrentTransaction.Cart=t;n.UI.updateCart();f.style.display="none";u.style.display="inline-block"},f.appendChild(e),f.appendChild(document.createTextNode(")")),u.appendChild(document.createTextNode(t)),o.appendChild(u),o.appendChild(f),o},i.createViewCartFooterRow=function(){var i=document.createElement("tr"),r,t;return i.appendChild(n.UI.createTableElement("","",4)),r=document.createElement("td"),t=document.createElement("button"),t.type="button",t.classList.add("button"),t.classList.add("is-success"),t.onclick=function(){var u=n.UI.Menus.filter(function(n){return n.id==="nav-cart"}),t=u[0],i=document.getElementById("menuTitle"),r=document.getElementById("menuSubTitle");Utilities.Clear_Element(i);Utilities.Clear_Element(r);i.appendChild(document.createTextNode(t.title));r.appendChild(document.createTextNode(t.subTitle));Utilities.Show_Menu(t.id)},t.appendChild(document.createTextNode("View Cart")),r.appendChild(t),i.appendChild(r),i},i}();n.Charge=i}(clayPay||(clayPay={})),function(n){var t,i;(function(n){n[n.cash=0]="cash";n[n.check=1]="check";n[n.credit_card_public=2]="credit_card_public";n[n.impact_fee_credit=3]="impact_fee_credit";n[n.impact_fee_exemption=4]="impact_fee_exemption";n[n.impact_fee_waiver_school=5]="impact_fee_waiver_school";n[n.impact_fee_waiver_road=6]="impact_fee_waiver_road";n[n.credit_card_cashier=7]="credit_card_cashier"})(t=n.payment_type||(n.payment_type={}));i=function(){function i(n){this.Editable=!1;this.Amount=0;this.CheckNumber="";this.TransactionId="";this.Validated=!1;this.Error="";this.PaymentType=n}return i.prototype.UpdateTotal=function(){var n=this.PaymentType===t.cash?i.cashAmountInput:i.checkAmountInput;Utilities.Set_Value(n,this.Amount.toFixed(2))},i.prototype.Validate=function(){return this.Validated==!1,this.Amount=0,this.CheckNumber="",this.TransactionId="",this.PaymentType===t.cash?this.ValidateCash():this.ValidateCheck()},i.prototype.ValidateCash=function(){this.Validated=!1;var t=document.getElementById(i.cashAmountInput),r=Utilities.Validate_Text(i.cashAmountInput,i.cashErrorElement,"You must enter an amount of 0 or greater in order to continue.");if(r.length!==0)return(this.Amount=parseFloat(r),n.isNaN(this.Amount)||this.Amount<0)?(t.classList.add("is-danger"),t.focus(),t.scrollTo(),this.Amount=0,Utilities.Error_Show(i.cashErrorElement,"An invalid amount was entered."),!1):this.Amount===0?(i.ResetCash(),!1):(this.Validated=!0,Utilities.Set_Text(i.cashPaymentTotalMenu,Utilities.Format_Amount(this.Amount)),Utilities.Hide(i.cashPaymentContainer),n.CurrentTransaction.Validate(),this.Validated)},i.prototype.ValidateCheck=function(){this.Validated=!1;var t=document.getElementById(i.checkAmountInput),r=Utilities.Validate_Text(i.checkAmountInput,i.checkErrorElement,"You must enter an amount of 0 or greater in order to continue.");if(r.length!==0)return(this.Amount=parseFloat(r),n.isNaN(this.Amount)||this.Amount<0)?(t.classList.add("is-danger"),t.focus(),t.scrollTo(),this.Amount=0,Utilities.Error_Show(i.checkErrorElement,"An invalid amount was entered."),!1):this.Amount>n.CurrentTransaction.TotalAmountDue?(t.classList.add("is-danger"),t.focus(),t.scrollTo(),Utilities.Error_Show(i.checkErrorElement,"You cannot enter an amount for more than the total amount due."),!1):(this.CheckNumber=Utilities.Validate_Text(i.checkNumberInput,i.checkErrorElement,"You must enter the check number to continue."),this.CheckNumber.length===0)?void 0:this.Amount===0?(i.ResetCheck(),!1):(this.Validated=!0,Utilities.Set_Text(i.checkPaymentTotalMenu,Utilities.Format_Amount(this.Amount)),Utilities.Hide(i.checkPaymentContainer),n.CurrentTransaction.Validate(),this.Validated)},i.ResetAll=function(){i.ResetCash();i.ResetCheck()},i.ResetCash=function(){var r,u;n.CurrentTransaction.CashPayment=new i(t.cash);r=document.getElementById(i.cashAmountInput);Utilities.Set_Value(r,"");r.classList.remove("is-danger");u=document.getElementById(i.cashPaymentTotalMenu);Utilities.Set_Text(u,"Add");Utilities.Hide(i.cashPaymentContainer);n.CurrentTransaction.Validate()},i.ResetCheck=function(){var r,u,f;n.CurrentTransaction.CheckPayment=new i(t.check);r=document.getElementById(i.checkAmountInput);Utilities.Set_Value(r,"");r.classList.remove("is-danger");u=document.getElementById(i.checkNumberInput);Utilities.Set_Value(u,"");u.classList.remove("is-danger");f=document.getElementById(i.checkPaymentTotalMenu);Utilities.Set_Text(f,"Add");Utilities.Hide(i.checkPaymentContainer);n.CurrentTransaction.Validate()},i.checkErrorElement="checkPaymentError",i.checkAmountInput="checkPaymentAmount",i.checkNumberInput="checkNumber",i.checkPaymentTotalMenu="checkPaymentTotal",i.checkPaymentContainer="checkPaymentType",i.cashErrorElement="cashPaymentError",i.cashAmountInput="cashPaymentAmount",i.cashPaymentTotalMenu="cashPaymentTotal",i.cashPaymentContainer="cashPaymentType",i}();n.Payment=i}(clayPay||(clayPay={})),function(n){var t=function(){function t(){this.Validated=!1}return t.prototype.UpdatePayerData=function(){Utilities.Set_Value(t.FirstNameInput,this.FirstName);Utilities.Set_Value(t.LastNameInput,this.LastName);Utilities.Set_Value(t.ZipCodeInput,this.ZipCode)},t.prototype.UpdateTotal=function(){Utilities.Set_Value(t.AmountPaidInput,this.Amount.toFixed(2))},t.prototype.ResetForm=function(){this.ResetData();this.ResetFormErrors();Utilities.Set_Value(t.FirstNameInput,"");Utilities.Set_Value(t.LastNameInput,"");Utilities.Set_Value(t.ZipCodeInput,"");Utilities.Set_Value(t.ccNumberInput,"");document.getElementById(t.ccTypeSelect).selectedIndex=0;document.getElementById(t.ccMonthSelect).selectedIndex=0;document.getElementById(t.ccYearSelect).selectedIndex=0;Utilities.Set_Value(t.ccCVCInput,"");n.CurrentTransaction.IsCashier&&(Utilities.Set_Value(t.AmountPaidInput,""),Utilities.Hide(t.CreditCardForm))},t.prototype.ResetData=function(){this.Amount=0;this.Validated=!1;this.FirstName="";this.LastName="";this.EmailAddress="";this.ZipCode="";this.CardNumber="";this.CardType="";this.ExpMonth="";this.ExpYear="";this.CVVNumber=""},t.prototype.ResetFormErrors=function(){document.getElementById(t.FirstNameInput).classList.remove("is-danger");document.getElementById(t.LastNameInput).classList.remove("is-danger");document.getElementById(t.ZipCodeInput).classList.remove("is-danger");document.getElementById(t.ccNumberInput).classList.remove("is-danger");document.getElementById(t.ccTypeSelect).parentElement.classList.remove("is-danger");document.getElementById(t.ccMonthSelect).parentElement.classList.remove("is-danger");document.getElementById(t.ccYearSelect).parentElement.classList.remove("is-danger");document.getElementById(t.ccCVCInput).classList.remove("is-danger");n.CurrentTransaction.IsCashier&&document.getElementById(t.AmountPaidInput).classList.remove("is-danger")},t.prototype.Validate=function(){var u,r,i;if((this.ResetData(),this.ResetFormErrors(),this.Validated=!1,this.FirstName=Utilities.Validate_Text(t.FirstNameInput,t.NameError,"The Firstname field is required."),this.FirstName.length!==0)&&(this.LastName=Utilities.Validate_Text(t.LastNameInput,t.NameError,"The Lastname field is required."),this.LastName.length!==0)&&(this.ZipCode=Utilities.Validate_Text(t.ZipCodeInput,t.ZipError,"The Zip code field is required."),this.ZipCode.length!==0)){if(this.ZipCode.length<5){Utilities.Error_Show(t.ZipError,"You must enter a Zip code of at least 5 digits.");i=document.getElementById(t.ZipCodeInput);i.classList.add("is-danger");i.focus();i.scrollTo();return}if((this.CardNumber=Utilities.Validate_Text(t.ccNumberInput,t.NumberError,"The Credit Card Number field is required."),this.CardNumber.length!==0)&&(this.CardType=Utilities.Validate_Text(t.ccTypeSelect,t.NumberError,"You must select a Card Type."),this.CardType.length!==0)){if(u=["AMEX","DISCOVER","MASTERCARD","VISA"],u.indexOf(this.CardType)===-1){Utilities.Error_Show(t.NumberError,"The credit card type appears to be invalid, please correct it and try again.");i=document.getElementById(t.ccTypeSelect);i.parentElement.classList.add("is-danger");i.focus();i.scrollTo();return}if(this.ExpMonth=Utilities.Validate_Text(t.ccMonthSelect,t.ExpirationError,"The Month Expiration field is required."),this.ExpMonth.length!==0){if(n.UI.ExpMonths.indexOf(this.ExpMonth)===-1){Utilities.Error_Show(t.ExpirationError,"The Expiration Month appears to be invalid, please correct it and try again.");i=document.getElementById(t.ccMonthSelect);i.parentElement.classList.add("is-danger");i.focus();i.scrollTo();return}if(this.ExpYear=Utilities.Validate_Text(t.ccYearSelect,t.ExpirationError,"The Year Expiration field is required."),this.ExpYear.length!==0){if(n.UI.ExpYears.indexOf(this.ExpYear)===-1){Utilities.Error_Show(t.ExpirationError,"The Expiration Year appears to be invalid, please correct it and try again.");i=document.getElementById(t.ccYearSelect);i.parentElement.classList.add("is-danger");i.focus();i.scrollTo();return}var e=parseInt(this.ExpYear),o=parseInt(this.ExpMonth),s=new Date(e,o-1,1),f=new Date,h=new Date(f.getFullYear(),f.getMonth(),1);if(s<h){Utilities.Error_Show(t.ExpirationError,"The expiration date entered has passed.  Please check it and try again.");i=document.getElementById(t.ccYearSelect);i.parentElement.classList.add("is-danger");i.focus();i.scrollTo();return}if(this.CVVNumber=Utilities.Validate_Text(t.ccCVCInput,t.ExpirationError,"The CV Code field is required."),this.CVVNumber.length!==0){if(n.CurrentTransaction.IsCashier){if(r=Utilities.Validate_Text(t.AmountPaidInput,t.AmountError,"The Amount field is required."),r.length===0)return;if(this.Amount=parseFloat(r),n.isNaN(this.Amount)||this.Amount<0)return this.Amount=0,Utilities.Error_Show(t.AmountError,"An invalid amount was entered."),!1;if(this.Amount>n.CurrentTransaction.TotalAmountDue)return i=document.getElementById(t.AmountPaidInput),i.classList.add("is-danger"),i.focus(),i.scrollTo(),Utilities.Error_Show(n.Payment.checkErrorElement,"You cannot enter an amount for more than the total amount due."),!1}else n.CurrentTransaction.CCData.Amount=n.CurrentTransaction.TotalAmountDue;return this.Validated=!0,n.CurrentTransaction.IsCashier&&(Utilities.Set_Text(t.creditCardTotalMenu,Utilities.Format_Amount(this.Amount)),Utilities.Hide(t.CreditCardForm)),n.CurrentTransaction.Validate()}}}}}},t.prototype.ValidateAndSave=function(){this.Validate()&&n.CurrentTransaction.Save()},t.CreditCardForm="creditCardPaymentType",t.FirstNameInput="creditCardFirstName",t.LastNameInput="creditCardLastName",t.ZipCodeInput="creditCardZip",t.ccNumberInput="creditCardNumber",t.ccTypeSelect="creditCardType",t.ccMonthSelect="creditCardMonth",t.ccYearSelect="creditCardYear",t.ccCVCInput="creditCardCVV",t.AmountPaidInput="creditCardPaymentAmount",t.NameError="creditCardNameError",t.ZipError="creditCardZipError",t.NumberError="creditCardNumberError",t.ExpirationError="creditCardExpirationError",t.AmountError="creditCardPaymentAmountError",t.creditCardTotalMenu="creditCardPaymentTotal",t}();n.CCPayment=t}(clayPay||(clayPay={})),function(n){var t=function(){function t(){this.CashierId="";this.PayId=-1;this.OTId=-1;this.Info="";this.TransactionDate=new Date;this.PaymentType="";this.PaymentTypeDescription="";this.AmountApplied=-1;this.AmountTendered=-1;this.ChangeDue=-1;this.ConvenienceFeeAmount=-1;this.CheckNumber="";this.TransactionId=""}return t.CreateReceiptPaymentView=function(n,i){for(var r,e,a,o,v,s,h=document.createDocumentFragment(),c=t.CreateTable(),u=document.createElement("TBODY"),f=0,l=n;f<l.length;f++)if(r=l[f],e=r.CheckNumber.length>0?r.CheckNumber:r.TransactionId,i)switch(r.PaymentTypeDescription.toLowerCase()){case"cash":u.appendChild(t.BuildCashPaymentRow(r));break;case"check":u.appendChild(t.BuildCheckPaymentRow(r));break;default:u.appendChild(t.BuildPaymentRow(r.PaymentTypeDescription,r.Info,e,r.AmountTendered,r.AmountApplied))}else u.appendChild(t.BuildPaymentRow(r.PaymentTypeDescription,r.Info,e,r.AmountTendered,r.AmountApplied));return a=n.filter(function(n){return n.ChangeDue>0}),o=a.reduce(function(n,t){return n+t.ChangeDue},0),o>0&&u.appendChild(t.BuildPaymentRow("Total Change Due","","",o,0)),v=n.filter(function(n){return n.ConvenienceFeeAmount>0}),s=v.reduce(function(n,t){return n+t.ConvenienceFeeAmount},0),s>0&&u.appendChild(t.BuildPaymentRow("Convenience Fee Estimate","","",s,0)),c.appendChild(u),h.appendChild(c),h},t.CreateTable=function(){var i=document.createElement("table"),r,t;return i.classList.add("table"),i.classList.add("table"),i.classList.add("is-fullwidth"),r=document.createElement("THEAD"),t=document.createElement("tr"),t.appendChild(n.UI.createTableHeaderElement("Payment Type","15%")),t.appendChild(n.UI.createTableHeaderElement("Info","35%")),t.appendChild(n.UI.createTableHeaderElement("Check/Trans#","20%")),t.appendChild(n.UI.createTableHeaderElement("Tendered","15%")),t.appendChild(n.UI.createTableHeaderElement("Applied","15%")),r.appendChild(t),i.appendChild(r),i},t.BuildPaymentRow=function(t,i,r,u,f){var e=document.createElement("tr");return e.appendChild(n.UI.createTableElement(t)),e.appendChild(n.UI.createTableElement(i)),e.appendChild(n.UI.createTableElement(r)),e.appendChild(n.UI.createTableElement(Utilities.Format_Amount(u))),t==="Convenience Fee Estimate"?e.appendChild(n.UI.createTableElement("")):e.appendChild(n.UI.createTableElement(Utilities.Format_Amount(f))),e},t.BuildCashPaymentRow=function(i){var e=document.createElement("tr"),o,h,f,c,r,u;e.appendChild(n.UI.createTableElement(i.PaymentTypeDescription));e.appendChild(n.UI.createTableElement(i.Info));var a=document.createElement("td"),l=document.createElement("div"),s=document.createElement("div");return s.classList.add("hide"),o=document.createElement("div"),o.classList.add("field"),o.classList.add("is-grouped"),h=document.createElement("div"),h.classList.add("control"),f=document.createElement("input"),f.classList.add("input"),f.placeholder="Enter Check Number",f.required=!0,f.type="text",c=document.createElement("div"),c.classList.add("control"),r=document.createElement("button"),r.type="button",r.classList.add("button"),r.classList.add("is-success"),r.appendChild(document.createTextNode("Save")),r.onclick=function(){var u=f.value,n;if(u.length===0){alert("You must enter a check number before you can save.");return}r.classList.add("is-loading");n=new t;n.CashierId=i.CashierId;n.OTId=i.OTId;n.PaymentType="CK";n.PayId=i.PayId;n.CheckNumber=u;t.SavePaymentChanges(n)},u=document.createElement("button"),u.type="button",u.classList.add("button"),u.classList.add("is-primary"),u.appendChild(document.createTextNode("Convert To Check")),u.onclick=function(){Utilities.Hide(u);Utilities.Show(s)},h.appendChild(f),c.appendChild(r),o.appendChild(h),o.appendChild(c),l.appendChild(u),s.appendChild(o),l.appendChild(s),a.appendChild(l),e.appendChild(a),e.appendChild(n.UI.createTableElement(Utilities.Format_Amount(i.AmountTendered))),e.appendChild(n.UI.createTableElement(Utilities.Format_Amount(i.AmountApplied))),e},t.BuildCheckPaymentRow=function(i){var u=document.createElement("tr"),f,r;return u.appendChild(n.UI.createTableElement(i.PaymentTypeDescription)),u.appendChild(n.UI.createTableElement(i.Info)),f=n.UI.createTableElement(i.CheckNumber),r=document.createElement("button"),r.type="button",r.classList.add("button"),r.classList.add("is-success"),r.appendChild(document.createTextNode("Convert To Cash Payment")),r.onclick=function(){r.classList.add("is-loading");var n=new t;n.CashierId=i.CashierId;n.OTId=i.OTId;n.PaymentType="CA";n.PayId=i.PayId;n.CheckNumber="";t.SavePaymentChanges(n)},f.appendChild(r),u.appendChild(f),u.appendChild(n.UI.createTableElement(Utilities.Format_Amount(i.AmountTendered))),u.appendChild(n.UI.createTableElement(Utilities.Format_Amount(i.AmountApplied))),u},t.SavePaymentChanges=function(t){var i="/",u=window.location.pathname.toLowerCase().indexOf("/claypay"),r;u==0&&(i="/claypay/");r=t;Utilities.Post(i+"API/Balancing/EditPayments",r).then(function(t){if(console.log("cr returned",t),t.Errors.length>0){alert("Errors occurred while attempting to save: "+t.Errors[0]);return}n.ClientResponse.BalancingSearch()},function(n){console.log("Save Payment Changes error",n)})},t}();n.ReceiptPayment=t}(clayPay||(clayPay={})),function(n){var t=function(){function t(){this.ResponseCashierData=new n.CashierData;this.Charges=[];this.ReceiptPayments=[];this.TransactionId="";this.IsEditable=!1;this.Errors=[];this.PartialErrors=[]}return t.ShowPaymentReceipt=function(n,i){console.log("client response ShowPaymentReceipt",n);var r=document.getElementById(i);Utilities.Clear_Element(r);r.appendChild(t.CreateReceiptView(n));Utilities.Show_Hide_Selector("#views > section",i)},t.CreateReceiptView=function(i){var r=document.createDocumentFragment();return i.ReceiptPayments.length===0?r:(r.appendChild(t.CreateReceiptHeader(i)),r.appendChild(t.CreateReceiptPayerView(i.ResponseCashierData)),r.appendChild(n.Charge.CreateChargesTable(i.Charges,n.ChargeView.receipt)),r.appendChild(n.ReceiptPayment.CreateReceiptPaymentView(i.ReceiptPayments,i.IsEditable)),r)},t.CreateReceiptHeader=function(n){var r=document.createElement("div"),t,i,u;return r.classList.add("level"),t=document.createElement("span"),t.classList.add("level-item"),t.classList.add("title"),t.appendChild(document.createTextNode("Payment Receipt for: "+n.ReceiptPayments[0].CashierId)),i=document.createElement("span"),i.classList.add("level-item"),i.classList.add("subtitle"),i.appendChild(document.createTextNode("Transaction Date: "+Utilities.Format_Date(n.ResponseCashierData.TransactionDate))),r.appendChild(t),r.appendChild(i),u=n.ResponseCashierData.TransactionDate,r},t.CreateReceiptPayerView=function(n){var i=document.createDocumentFragment(),r,u;return n.IsVoided&&(r=document.createElement("div"),r.classList.add("level"),r.classList.add("notification"),r.classList.add("is-danger"),u=document.createElement("p"),u.classList.add("level-item"),u.classList.add("title"),u.appendChild(document.createTextNode("This transaction has been voided.")),r.appendChild(u),i.appendChild(r)),i.appendChild(t.CreatePayerDataColumns("Name",n.PayerName,"Company Name",n.PayerCompanyName)),i.appendChild(t.CreatePayerDataColumns("Phone Number",n.PayerPhoneNumber,"Email Address",n.PayerEmailAddress)),i.appendChild(t.CreatePayerDataColumns("Street Address",n.PayerStreet1,"Address 2",n.PayerStreet2)),i.appendChild(t.CreatePayerDataColumns("Processed By",n.UserName,"","")),i},t.CreatePayerDataColumns=function(n,i,r,u){var f=document.createElement("div");return f.classList.add("columns"),f.style.marginBottom="0",f.appendChild(t.CreatePayerData(n,i)),f.appendChild(t.CreatePayerData(r,u)),f},t.CreatePayerData=function(n,t){var r=document.createElement("div"),u,f,i;return r.classList.add("field"),r.classList.add("column"),u=document.createElement("label"),u.classList.add("label"),u.appendChild(document.createTextNode(n)),f=document.createElement("div"),f.classList.add("control"),i=document.createElement("input"),i.classList.add("input"),i.classList.add("is-static"),i.readOnly=!0,i.type="text",i.value=t,f.appendChild(i),r.appendChild(u),r.appendChild(f),r},t.Search=function(){var i,n,r,u;if(Utilities.Toggle_Loading_Button(t.receiptSearchButton,!0),i=document.getElementById(t.receiptSearchInput),n=i.value.trim().toUpperCase(),n.length!==9){Utilities.Error_Show(t.receiptSearchError,"Receipts must be 8 digits and a dash, like 18-000001.");return}n.length>0?(r="/",u=window.location.pathname.toLowerCase().indexOf("/claypay"),u==0&&(r="/claypay/"),Utilities.Get(r+"API/Payments/Receipt/?CashierId="+n).then(function(n){console.log("Client Response",n);n.Errors.length>0?Utilities.Error_Show(t.receiptSearchError,n.Errors):t.ShowPaymentReceipt(n,t.PaymentReceiptContainer);Utilities.Toggle_Loading_Button(t.receiptSearchButton,!1)},function(n){console.log("error in Receipt Search",n);Utilities.Error_Show(t.receiptSearchError,n);Utilities.Toggle_Loading_Button(t.receiptSearchButton,!1)})):(Utilities.Error_Show(t.receiptSearchError,"Invalid search. Please check your entry and try again."),i.focus(),Utilities.Toggle_Loading_Button(t.receiptSearchButton,!1))},t.BalancingSearch=function(t){t===void 0&&(t=null);var i=Utilities.Get_Value("receiptSearch"),r="/",u="",f=window.location.pathname.toLowerCase().indexOf("/claypay");f==0&&(r="/claypay/");u="?CashierId="+i;Utilities.Get(r+"API/Balancing/Receipt"+u).then(function(r){console.log("client response",r);t!==null&&Utilities.Set_Text(t,i);n.ClientResponse.ShowPaymentReceipt(r,Balancing.Payment.DJournalReceiptContainer);var u=Balancing.Menus.filter(function(n){return n.id==="nav-receipts"}),f=u[0];Utilities.Update_Menu(f)},function(n){console.log("error getting client response for cashier id: "+i,n);t!==null&&Utilities.Set_Text(t,i)})},t.CashierErrorTarget="paymentError",t.PublicErrorTarget="publicPaymentError",t.PaymentReceiptContainer="receipt",t.BalancingReceiptContainer="receiptView",t.receiptSearchInput="receiptSearch",t.receiptSearchButton="receiptSearchButton",t.receiptSearchError="receiptSearchError",t}();n.ClientResponse=t}(clayPay||(clayPay={})),function(n){var t=function(){function t(){this.CurrentCharges=[];this.Cart=[];this.OTid=0;this.CashierId="";this.ItemIds=[];this.CCData=new n.CCPayment;this.Payments=[];this.TransactionCashierData=new n.CashierData;this.IsCashier=!1;this.CheckPayment=new n.Payment(n.payment_type.check);this.CashPayment=new n.Payment(n.payment_type.cash);this.TotalAmountDue=0;this.TotalAmountPaid=0;this.TotalAmountRemaining=0;this.TotalChangeDue=0}return t.prototype.UpdateIsCashier=function(){var t=document.getElementById(n.Payment.checkPaymentContainer);this.IsCashier=t!==undefined&&t!==null},t.prototype.Validate=function(){var n=this.TransactionCashierData.ValidatePayer(),i,r;if(n)Utilities.Hide("validatePayer"),Utilities.Show("paymentData");else return Utilities.Show("validatePayer"),Utilities.Hide("paymentData"),!1;return this.IsCashier?(this.UpdateTotals(),i=this.ValidatePayments(),r=document.getElementById(t.PayNowCashierButton),r.disabled=!(n&&i),n&&i):!0},t.prototype.UpdateTotals=function(){if(this.IsCashier){this.TotalAmountPaid=0;this.TotalAmountRemaining=0;this.TotalChangeDue=0;var n=0;this.CheckPayment.Validated&&(n+=this.CheckPayment.Amount);this.CashPayment.Validated&&(n+=this.CashPayment.Amount);this.CCData.Validated&&(n+=this.CCData.Amount);this.TotalAmountPaid=n;this.TotalAmountRemaining=Math.max(this.TotalAmountDue-this.TotalAmountPaid,0);this.TotalAmountDue-this.TotalAmountPaid<0&&(this.TotalChangeDue=this.TotalAmountPaid-this.TotalAmountDue);this.UpdateForm()}},t.prototype.UpdateForm=function(){Utilities.Set_Text(t.TotalAmountDueMenu,Utilities.Format_Amount(this.TotalAmountDue));Utilities.Set_Text(t.TotalAmountPaidMenu,Utilities.Format_Amount(this.TotalAmountPaid));Utilities.Set_Text(t.TotalChangeDueMenu,Utilities.Format_Amount(this.TotalChangeDue));Utilities.Set_Text(t.TotalAmountRemainingMenu,Utilities.Format_Amount(this.TotalAmountRemaining));var i=this.TotalAmountRemaining.toFixed(2);this.CCData.Validated||Utilities.Set_Value(n.CCPayment.AmountPaidInput,i);this.CheckPayment.Validated||Utilities.Set_Value(n.Payment.checkAmountInput,i);this.CashPayment.Validated||Utilities.Set_Value(n.Payment.cashAmountInput,i)},t.prototype.ValidatePayments=function(){if(this.IsCashier){if(this.CashPayment.Validated&&this.CashPayment.Amount>0&&this.TotalChangeDue>=this.CashPayment.Amount)return Utilities.Error_Show(t.paymentError,"The Total Change due the customer cannot be more than or equal to the amount of Cash paid."),!1;if(this.TotalChangeDue>0&&(!this.CashPayment.Validated||this.CashPayment.Amount===0))return Utilities.Error_Show(t.paymentError,"The Total Amount Paid cannot be greater than the Total Amount Due if no cash has been received."),!1;if(this.TotalAmountRemaining>0)return!1}return!0},t.prototype.CopyPayerData=function(){this.CCData.FirstName=this.TransactionCashierData.PayerFirstName;this.CCData.LastName=this.TransactionCashierData.PayerLastName;this.CCData.ZipCode=this.TransactionCashierData.PayerZip;this.CCData.UpdatePayerData()},t.prototype.Save=function(){var i=this.IsCashier?t.PayNowCashierButton:t.PayNowPublicButton;if(Utilities.Toggle_Loading_Button(i,!0),!this.Validate()){Utilities.Toggle_Loading_Button(i,!1);return}this.ItemIds=n.CurrentTransaction.Cart.map(function(n){return n.ItemId});this.Payments=[];var r=this.IsCashier,u=r?t.PayNowCashierButton:t.PayNowPublicButton,f=r?n.ClientResponse.CashierErrorTarget:n.ClientResponse.PublicErrorTarget,e="/",o=window.location.pathname.toLowerCase().indexOf("/claypay");o==0&&(e="/claypay/");Utilities.Post(e+"API/Payments/Pay/",this).then(function(i){console.log("client response",i);i.Errors.length>0?Utilities.Error_Show(f,i.Errors):(n.CurrentTransaction.IsCashier&&n.Payment.ResetAll(),n.CurrentTransaction.TransactionCashierData.ResetPayerForm(),n.CurrentTransaction.CCData.ResetForm(),n.CurrentTransaction=new t,n.UI.updateCart(),n.ClientResponse.ShowPaymentReceipt(i,n.ClientResponse.PaymentReceiptContainer));Utilities.Toggle_Loading_Button(u,!1)},function(n){Utilities.Error_Show(f,n);Utilities.Toggle_Loading_Button(u,!1)})},t.TotalAmountPaidMenu="cartTotalAmountPaid",t.TotalAmountDueMenu="cartTotalAmountDue",t.TotalAmountRemainingMenu="cartTotalAmountRemaining",t.TotalChangeDueMenu="cartTotalChangeDue",t.PayNowCashierButton="processPayments",t.PayNowPublicButton="processCCPayment",t.paymentError="paymentError",t}();n.NewTransaction=t}(clayPay||(clayPay={})),function(n){var t=function(){function n(n,t){this.Label=n;this.Value=t}return n}();n.AppType=t}(clayPay||(clayPay={})),function(n){"use strict";function r(){n.CurrentTransaction.UpdateIsCashier();u();n.UI.buildMenuElements(n.CurrentTransaction.IsCashier);f();window.onhashchange=i}function i(){var r=location.hash,i=new n.LocationHash(location.hash.substring(1));if(i.Permit.length>0){Utilities.Update_Menu(n.UI.Menus[1]);t("permitSearchButton","permitSearch",i.Permit);return}if(i.CashierId.length>0){Utilities.Update_Menu(n.UI.Menus[5]);t("receiptSearchButton","receiptSearch",i.CashierId);return}if(i.ContractorId.length>0){Utilities.Update_Menu(n.UI.Menus[2]);t("contractorSearchButton","contractorSearch",i.ContractorId);return}if(i.ApplicationNumber.length>0){Utilities.Update_Menu(n.UI.Menus[3]);t("applicationSearchButton","applicationSearch",i.ApplicationNumber);return}}function t(n,t,i){console.log("buttonid",n,"inputId",t,"value",i);var r=document.getElementById(n);Utilities.Set_Value(t,i);r.click()}function u(){document.getElementById("permitSearch").onkeydown=function(t){var i=t||window.event;t.keyCode==13&&n.UI.Search("permitSearchButton","permitSearch","permitSearchError")};document.getElementById("permitSearchButton").onclick=function(){n.UI.Search("permitSearchButton","permitSearch","permitSearchError")};document.getElementById("contractorSearch").onkeydown=function(t){var i=t||window.event;t.keyCode==13&&n.UI.Search("contractorSearchButton","contractorSearch","contractorSearchError")};document.getElementById("contractorSearchButton").onclick=function(){n.UI.Search("contractorSearchButton","contractorSearch","contractorSearchError")};document.getElementById("applicationSearch").onkeydown=function(t){var i=t||window.event;t.keyCode==13&&n.UI.Search("applicationSearchButton","applicationSearch","applicationSearchError")};document.getElementById("applicationSearchButton").onclick=function(){n.UI.Search("applicationSearchButton","applicationSearch","applicationSearchError")};document.getElementById("receiptSearch").onkeydown=function(t){var i=t||window.event;t.keyCode==13&&n.ClientResponse.Search()};document.getElementById("receiptSearchButton").onclick=function(){n.ClientResponse.Search()}}function f(){s();n.UI.BuildPayerStates(n.UI.AllStates,"payerState");o();e()}function e(){n.UI.BuildExpMonths("creditCardMonth");n.UI.BuildExpYears("creditCardYear")}function o(){var t="/",r=window.location.pathname.toLowerCase().indexOf("/claypay");r==0&&(t="/claypay/");Utilities.Get(t+"API/Payments/Fee/").then(function(t){n.ConvenienceFee=t;console.log("conv fee is",t);location.hash.substring(1).length>0&&i()},function(n){console.log("error getting convenience fee",n)})}function s(){var t="/",i=window.location.pathname.toLowerCase().indexOf("/claypay");i==0&&(t="/claypay/");Utilities.Get(t+"API/Payments/Apptypes/").then(function(t){n.UI.BuildAppTypes(t)},function(n){console.log("error getting application types",n)})}function h(n){return n!==n}n.CurrentTransaction=new n.NewTransaction;n.start=r;n.HandleHash=i;n.isNaN=h}(clayPay||(clayPay={})),function(n){var t;(function(t){"use strict";function u(n,t){var i=document.getElementById(t);i!==undefined&&(Utilities.Clear_Element(i),n.forEach(function(n){i.appendChild(Utilities.Create_Option(n.abv,n.state))}),i.selectedIndex=0)}function f(n){var t=document.getElementById("applicationSearchType");Utilities.Clear_Element(t);t.appendChild(Utilities.Create_Option("-1","Select Application Type",!0));n.forEach(function(n){t.appendChild(Utilities.Create_Option(n.Value,n.Label))});t.selectedIndex=0}function e(n){var i=document.getElementById(n),r,u,f;if(i!==undefined){for(Utilities.Clear_Element(i),r=0,u=t.ExpMonths;r<u.length;r++)f=u[r],i.appendChild(Utilities.Create_Option(f,f));i.selectedIndex=0}}function o(n){var u=document.getElementById(n),f,i,r;for(Utilities.Clear_Element(u),f=(new Date).getFullYear(),i=0;i<10;i++)r=(f+i).toString(),u.appendChild(Utilities.Create_Option(r,r)),t.ExpYears.push(r)}function s(t,r,u){var e,f,o,s,h;if(Utilities.Toggle_Loading_Button(t,!0),e=document.getElementById(r),f=e.value.trim().toUpperCase(),r.indexOf("application")>-1){if(o=document.getElementById(r+"Type").value,o==="-1"||o.length===0)return Utilities.Error_Show(u,"You must select an Application Type in order to search by Application Number."),Utilities.Toggle_Loading_Button(t,!1),!1;f=o.toUpperCase()+"-"+e.value.trim().toUpperCase()}if(f.length>0)s="/",h=window.location.pathname.toLowerCase().indexOf("/claypay"),h==0&&(s="/claypay/"),Utilities.Get(s+"API/Payments/Query/?key="+f).then(function(r){return n.CurrentTransaction.CurrentCharges=r,r.length>0?(i(r),Utilities.Show("searchResults")):Utilities.Error_Show(u,"No charges were found for search: "+f),Utilities.Toggle_Loading_Button(t,!1),!0},function(n){return Utilities.Error_Show(u,n),console.log("error getting charges"),Utilities.Toggle_Loading_Button(t,!1),!1});else return Utilities.Error_Show(u,"Invalid search. Please check your entry and try again."),e.focus(),Utilities.Toggle_Loading_Button(t,!1),!1}function i(t){var i=document.getElementById("Charges");Utilities.Clear_Element(i);i.appendChild(n.Charge.CreateChargesTable(t,n.ChargeView.search_results));Utilities.Set_Text("ChargesKey",t[0].AssocKey);Utilities.Set_Text("ChargesDetail",t[0].Detail)}function r(t){var i=n.CurrentTransaction.Cart.filter(function(n){return n.ItemId==t});return i.length!==0}function h(n,t){var i=document.createElement("th");return i.width=t,i.appendChild(document.createTextNode(n)),i}function c(n,t,i){var r=document.createElement("td");return t!==undefined&&(r.className=t),i!==undefined&&(r.colSpan=i),r.appendChild(document.createTextNode(n)),r}function l(n,t,i,u,f,e){var l=r(t),c=document.createElement("td"),o,s,h;return c.className=i,o=document.createElement("button"),o.style.display=l?"none":"inline-block",o.type="button",o.id="btnAdd"+t.toString(),o.className="button is-primary",o.onclick=function(n){f(n,t)},s=document.createElement("div"),s.id="btnRemove"+t.toString(),s.style.display=l?"inline-block":"none",s.appendChild(document.createTextNode("Added (")),h=document.createElement("a"),h.classList.add("is-warning"),h.style.cursor="pointer",h.appendChild(document.createTextNode("remove")),h.onclick=function(n){e(n,t,u)},s.appendChild(h),s.appendChild(document.createTextNode(")")),o.appendChild(document.createTextNode(n)),c.appendChild(o),c.appendChild(s),c}function a(){var t=document.getElementById("nav-cart-total"),r=document.getElementById("emptyCart"),u=document.getElementById("fullCart"),f=document.getElementById("payerData"),e=document.getElementById("paymentData"),i;Utilities.Hide(r);Utilities.Hide(u);Utilities.Hide(f);Utilities.Clear_Element(t);n.CurrentTransaction.Cart.length===0?(t.appendChild(document.createTextNode("(empty)")),Utilities.Show(r)):(i=n.CurrentTransaction.Cart.length,t.appendChild(document.createTextNode(+i.toString()+(i===1?" item":" items"))),Utilities.Show(u),Utilities.Show(f))}function v(){var t=document.getElementById("fullCart");Utilities.Clear_Element(t);t.appendChild(n.Charge.CreateChargesTable(n.CurrentTransaction.Cart,n.ChargeView.cart));a()}function y(n){for(var i,u=document.getElementById("menuTabs"),r=0,f=t.Menus;r<f.length;r++)i=f[r],n?u.appendChild(Utilities.Create_Menu_Element(i)):i.id!=="nav-existingReceipts"&&u.appendChild(Utilities.Create_Menu_Element(i));p()}function p(){var t=document.getElementById("nav-cart"),n=document.createElement("span");n.id="nav-cart-total";n.style.fontSize="larger";n.style.fontWeight="bolder";n.style.paddingLeft="1em";n.appendChild(document.createTextNode("(empty)"));t.appendChild(n)}t.ExpMonths=["01","02","03","04","05","06","07","08","09","10","11","12"];t.AllStates=[{state:"Select",abv:""},{state:"ALABAMA",abv:"AL"},{state:"ALASKA",abv:"AK"},{state:"ARIZONA",abv:"AZ"},{state:"ARKANSAS",abv:"AR"},{state:"CALIFORNIA",abv:"CA"},{state:"COLORADO",abv:"CO"},{state:"CONNECTICUT",abv:"CT"},{state:"DELAWARE",abv:"DE"},{state:"FLORIDA",abv:"FL"},{state:"GEORGIA",abv:"GA"},{state:"HAWAII",abv:"HI"},{state:"IDAHO",abv:"ID"},{state:"ILLINOIS",abv:"IL"},{state:"INDIANA",abv:"IN"},{state:"IOWA",abv:"IA"},{state:"KANSAS",abv:"KS"},{state:"KENTUCKY",abv:"KY"},{state:"LOUISIANA",abv:"LA"},{state:"MAINE",abv:"ME"},{state:"MARYLAND",abv:"MD"},{state:"MASSACHUSETTS",abv:"MA"},{state:"MICHIGAN",abv:"MI"},{state:"MINNESOTA",abv:"MN"},{state:"MISSISSIPPI",abv:"MS"},{state:"MISSOURI",abv:"MO"},{state:"MONTANA",abv:"MT"},{state:"NEBRASKA",abv:"NE"},{state:"NEVADA",abv:"NV"},{state:"NEW HAMPSHIRE",abv:"NH"},{state:"NEW JERSEY",abv:"NJ"},{state:"NEW MEXICO",abv:"NM"},{state:"NEW YORK",abv:"NY"},{state:"NORTH CAROLINA",abv:"NC"},{state:"NORTH DAKOTA",abv:"ND"},{state:"OHIO",abv:"OH"},{state:"OKLAHOMA",abv:"OK"},{state:"OREGON",abv:"OR"},{state:"PENNSYLVANIA",abv:"PA"},{state:"RHODE ISLAND",abv:"RI"},{state:"SOUTH CAROLINA",abv:"SC"},{state:"SOUTH DAKOTA",abv:"SD"},{state:"TENNESSEE",abv:"TN"},{state:"TEXAS",abv:"TX"},{state:"UTAH",abv:"UT"},{state:"VERMONT",abv:"VT"},{state:"VIRGINIA",abv:"VA"},{state:"WASHINGTON",abv:"WA"},{state:"WEST VIRGINIA",abv:"WV"},{state:"WISCONSIN",abv:"WI"},{state:"WYOMING",abv:"WY"}];t.ExpYears=[];t.Menus=[{id:"nav-Home",title:"Welcome!",subTitle:"You can use this application to easily find and pay Clay County fees.",icon:"fas fa-home",label:"Home",selected:!0},{id:"nav-permitFees",title:"Search by Permit Number",subTitle:"Searching by Permit number will show you all of the unpaid fees for a given permit number.",icon:"fas fa-file",label:"Permit Fees",selected:!1},{id:"nav-contractorFees",title:"Search by Contractor ID number",subTitle:"Searching by Contractor ID will list any unpaid fees for a given contractor.",icon:"fas fa-user",label:"Contractor Fees",selected:!1},{id:"nav-applicationFees",title:"Search by Application Type and Application Number",subTitle:"Pick an application type and then enter an application number to see any unpaid fees associated with that application.",icon:"fas fa-clipboard",label:"Application Fees",selected:!1},{id:"nav-cart",title:"Your Shopping Cart",subTitle:"Shows the charges you have added to your shopping cart. You can pay for them here.",icon:"fas fa-shopping-cart",label:"Cart",selected:!1},{id:"nav-existingReceipts",title:"View Existing Receipts",subTitle:"Shows the Transaction Date, Charges Paid, and method of payment for a receipt number.",icon:"fas fa-file",label:"Receipt Search",selected:!1},];t.BuildPayerStates=u;t.BuildAppTypes=f;t.BuildExpMonths=e;t.BuildExpYears=o;t.Search=s;t.ProcessSearchResults=i;t.IsItemInCart=r;t.createTableHeaderElement=h;t.createTableElement=c;t.createTableElementButton=l;t.updateCart=v;t.buildMenuElements=y})(t=n.UI||(n.UI={}))}(clayPay||(clayPay={}));